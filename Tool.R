library(shiny)
library(readxl)
library(markovchain)
library(expm)

#Interfaz en Shiny
ui = fluidPage(
  #Titulo del panel
  titlePanel("Herramienta Colflores"),
  titlePanel("Carga de archivos"),
  sidebarLayout(
    sidebarPanel(
      #Pestanas del panel
      tabsetPanel(id = "tabset", 
                  #Pestana para fase 3
                  tabPanel("Fase 3",
                           
                           fileInput('file1', 'Cargar Archivo Excel Finanzas',
                                     accept = c(".xlsx")
                           ),
                           
                           numericInput("costofijo", "Costo fijo de cosechar", 324000),
                           titlePanel('Toma de decicion en la alternativa financiera'),
                           tableOutput('contents1'),
                           tableOutput('contents11'),
                           titlePanel('Toma de decicion en la alternativa de produccion'),
                           tableOutput('contents2'),
                           tableOutput('contents12'),
                           tableOutput('contents123'),
                           
                           plotOutput("G1",
                                      click = "plot_click",
                                      dblclick = "plot_dblclick",
                                      hover = "plot_hover",
                                      brush = "plot_brush"),
                           plotOutput("G2",
                                      click = "plot_click",
                                      dblclick = "plot_dblclick",
                                      hover = "plot_hover",
                                      brush = "plot_brush"),
                           plotOutput("G3",
                                      click = "plot_click",
                                      dblclick = "plot_dblclick",
                                      hover = "plot_hover",
                                      brush = "plot_brush")
                  ),
                  
                  #Pestana para fase 3
                  tabPanel("Fase 2", 
                           
                           numericInput("cantidadRosas", "Cantidad de rosas enviadas", 2000),
                           numericInput("costoProduccion", "Costo de produccion", 0.4),
                           #Boton de accion
                           actionButton("Actualizar1", "Generar resultados", icon = NULL, width = NULL)),
                  
                  #Pestana para fase 3
                  tabPanel("Fase 1", 
                           
                           fileInput('file2', 'Cargar Archivo Excel Finanzas',
                                     accept = c(".xlsx")
                           ),
                           
                           #Parametros   
                           numericInput("cantidadRosas1", "Cantidad de rosas enviadas", 2000),
                           numericInput("costoProduccion1", "Costo de produccion", 0.4),
                           actionButton("Actualizar2", "Generar resultados", icon = NULL, width = NULL))
                  #tableOutput('contents22'),
                  
                  
                  
                  
      )),
    
    
    #Panel Principal para mostrar resultados
    mainPanel(
      
      tableOutput("Resultados"),
      
      #Grafica 1
      plotOutput("G11",
                 click = "plot_click",
                 dblclick = "plot_dblclick",
                 hover = "plot_hover",
                 brush = "plot_brush"
      ),
      verbatimTextOutput("info1"),
      tableOutput("Alt1"),
      
      #Grafica 2
      plotOutput("G22",
                 click = "plot_click",
                 dblclick = "plot_dblclick",
                 hover = "plot_hover",
                 brush = "plot_brush"
      ),
      verbatimTextOutput("info2"),
      tableOutput("Alt2"),
      
      #Grafica 3
      tableOutput("Alt3"),
      
      plotOutput("G33",
                 click = "plot_click",
                 dblclick = "plot_dblclick",
                 hover = "plot_hover",
                 brush = "plot_brush"
      ),
      tableOutput("Alt4")
      
    )
  )
)



server = function(input, output){
  #Fase 1
  #
  #
  #
  #
  #
  #
  #Actualizar datos con boton
  observeEvent(input$Actualizar2,{
    
    #Matrices de la CMTD
    p <- c(  0.303030303030303, 	 0.409090909090909, 	 0.166666666666667, 	 0.121212121212121, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
             0.293103448275862, 	 0.344827586206897, 	 0.189655172413793, 	 0.129310344827586, 	 0.0344827586206897, 	 0.00862068965517241, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
             0.0769230769230769, 	 0.259615384615385, 	 0.307692307692308, 	 0.153846153846154, 	 0.163461538461538, 	 0.0384615384615385, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
             0.00943396226415094, 	 0.132075471698113, 	 0.141509433962264, 	 0.254716981132075, 	 0.254716981132075, 	 0.160377358490566, 	 0.0283018867924528, 	 0.00943396226415094, 	 0.00943396226415094, 	 0, 	 0, 	 0, 
             0.0252100840336134, 	 0.0588235294117647, 	 0.109243697478992, 	 0.159663865546218, 	 0.235294117647059, 	 0.235294117647059, 	 0.109243697478992, 	 0.0420168067226891, 	 0.0168067226890756, 	 0.00840336134453781, 	 0, 	 0, 
             0, 	 0.00819672131147541, 	 0.0655737704918033, 	 0.122950819672131, 	 0.180327868852459, 	 0.270491803278689, 	 0.172131147540984, 	 0.147540983606557, 	 0.0327868852459016, 	 0, 	 0, 	 0, 
             0, 	 0, 	 0.029126213592233, 	 0.0388349514563107, 	 0.106796116504854, 	 0.16504854368932, 	 0.223300970873786, 	 0.262135922330097, 	 0.12621359223301, 	 0.0388349514563107, 	 0.00970873786407767, 	 0, 
             0, 	 0, 	 0, 	 0.00675675675675676, 	 0.0675675675675676, 	 0.101351351351351, 	 0.141891891891892, 	 0.283783783783784, 	 0.195945945945946, 	 0.155405405405405, 	 0.0337837837837838, 	 0.0135135135135135, 
             0, 	 0, 	 0, 	 0.00763358778625954, 	 0, 	 0.0381679389312977, 	 0.106870229007634, 	 0.206106870229008, 	 0.282442748091603, 	 0.198473282442748, 	 0.106870229007634, 	 0.0534351145038168, 
             0, 	 0, 	 0, 	 0, 	 0, 	 0.008, 	 0.056, 	 0.152, 	 0.256, 	 0.256, 	 0.184, 	 0.088, 
             0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0114942528735632, 	 0.0919540229885057, 	 0.0804597701149425, 	 0.264367816091954, 	 0.32183908045977, 	 0.229885057471264, 
             0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0138888888888889, 	 0.0833333333333333, 	 0.236111111111111, 	 0.222222222222222, 	 0.444444444444444 
             
    )
    
    mPrecio = matrix(p, nrow = 12, byrow = TRUE)
    
    
    
    g <- c( 0.727272727272727, 	 0.181818181818182, 	 0, 	 0.0909090909090909, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0.25, 	 0, 	 0, 	 0.25, 	 0, 	 0.5, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0.4, 	 0.4, 	 0, 	 0.2, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0.2, 	 0, 	 0.2, 	 0, 	 0.2, 	 0.4, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0.142857142857143, 	 0, 	 0, 	 0.142857142857143, 	 0.285714285714286, 	 0.142857142857143, 	 0.285714285714286, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0.222222222222222, 	 0.111111111111111, 	 0.333333333333333, 	 0.333333333333333, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0.0454545454545455, 	 0.0454545454545455, 	 0.0909090909090909, 	 0.318181818181818, 	 0.318181818181818, 	 0.0909090909090909, 	 0.0909090909090909, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0.0476190476190476, 	 0.0476190476190476, 	 0, 	 0.0476190476190476, 	 0.285714285714286, 	 0.142857142857143, 	 0.238095238095238, 	 0.0952380952380952, 	 0.0952380952380952, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0555555555555556, 	 0.222222222222222, 	 0.277777777777778, 	 0.277777777777778, 	 0.111111111111111, 	 0.0555555555555556, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.1, 	 0.15, 	 0.25, 	 0.15, 	 0.15, 	 0.1, 	 0.05, 	 0.05, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0645161290322581, 	 0.032258064516129, 	 0.0645161290322581, 	 0.0967741935483871, 	 0.451612903225806, 	 0.193548387096774, 	 0.0967741935483871, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0526315789473684, 	 0.0526315789473684, 	 0.157894736842105, 	 0.157894736842105, 	 0.157894736842105, 	 0.210526315789474, 	 0.157894736842105, 	 0, 	 0.0526315789473684, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.294117647058824, 	 0.117647058823529, 	 0, 	 0.294117647058824, 	 0.294117647058824, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0384615384615385, 	 0, 	 0.115384615384615, 	 0.307692307692308, 	 0.307692307692308, 	 0.153846153846154, 	 0.0384615384615385, 	 0.0384615384615385, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.1, 	 0.133333333333333, 	 0.166666666666667, 	 0.233333333333333, 	 0.233333333333333, 	 0.1, 	 0.0333333333333333, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0344827586206897, 	 0.0344827586206897, 	 0.0344827586206897, 	 0.103448275862069, 	 0.137931034482759, 	 0.275862068965517, 	 0.206896551724138, 	 0.0344827586206897, 	 0.137931034482759, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0357142857142857, 	 0.107142857142857, 	 0.214285714285714, 	 0.214285714285714, 	 0.142857142857143, 	 0.107142857142857, 	 0.107142857142857, 	 0.0357142857142857, 	 0, 	 0.0357142857142857, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.105263157894737, 	 0.0526315789473684, 	 0.315789473684211, 	 0.157894736842105, 	 0.315789473684211, 	 0.0526315789473684, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0416666666666667, 	 0.125, 	 0.166666666666667, 	 0.0416666666666667, 	 0.333333333333333, 	 0.125, 	 0.0416666666666667, 	 0.0833333333333333, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0.0833333333333333, 	 0.208333333333333, 	 0.291666666666667, 	 0.25, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.027027027027027, 	 0.0810810810810811, 	 0.027027027027027, 	 0.162162162162162, 	 0.108108108108108, 	 0.297297297297297, 	 0.189189189189189, 	 0.0810810810810811, 	 0.027027027027027, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0512820512820513, 	 0.0256410256410256, 	 0.205128205128205, 	 0.307692307692308, 	 0.205128205128205, 	 0.102564102564103, 	 0.0769230769230769, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0256410256410256, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.02, 	 0, 	 0.04, 	 0.08, 	 0.12, 	 0.26, 	 0.3, 	 0.1, 	 0.04, 	 0.02, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.02, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0153846153846154, 	 0.0923076923076923, 	 0.169230769230769, 	 0.307692307692308, 	 0.246153846153846, 	 0.138461538461538, 	 0.0307692307692308, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0144927536231884, 	 0.0144927536231884, 	 0.072463768115942, 	 0.246376811594203, 	 0.333333333333333, 	 0.217391304347826, 	 0.0869565217391304, 	 0.0144927536231884, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0178571428571429, 	 0, 	 0.0714285714285714, 	 0.107142857142857, 	 0.267857142857143, 	 0.232142857142857, 	 0.178571428571429, 	 0.0714285714285714, 	 0.0535714285714286, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.111111111111111, 	 0.185185185185185, 	 0.407407407407407, 	 0.240740740740741, 	 0.037037037037037, 	 0, 	 0.0185185185185185, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.025, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.025, 	 0.025, 	 0.075, 	 0.225, 	 0.225, 	 0.225, 	 0.1, 	 0.025, 	 0.025, 	 0, 	 0.025, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0731707317073171, 	 0.0975609756097561, 	 0.195121951219512, 	 0.24390243902439, 	 0.24390243902439, 	 0.121951219512195, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.024390243902439, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.111111111111111, 	 0.361111111111111, 	 0.305555555555556, 	 0.138888888888889, 	 0.0277777777777778, 	 0.0277777777777778, 	 0, 	 0.0277777777777778, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0.0333333333333333, 	 0, 	 0.266666666666667, 	 0.433333333333333, 	 0.133333333333333, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0714285714285714, 	 0.142857142857143, 	 0.142857142857143, 	 0.357142857142857, 	 0.214285714285714, 	 0.0714285714285714, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.05, 	 0.1, 	 0.1, 	 0.25, 	 0.15, 	 0.05, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.142857142857143, 	 0, 	 0, 	 0.142857142857143, 	 0.285714285714286, 	 0.285714285714286, 	 0.0714285714285714, 	 0.0714285714285714, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0, 	 0.125, 	 0.25, 	 0.375, 	 0.125, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0555555555555556, 	 0.0555555555555556, 	 0.0555555555555556, 	 0.388888888888889, 	 0.333333333333333, 	 0.0555555555555556, 	 0, 	 0.0555555555555556, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0526315789473684, 	 0.210526315789474, 	 0.368421052631579, 	 0.263157894736842, 	 0.105263157894737, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0714285714285714, 	 0.0714285714285714, 	 0.0714285714285714, 	 0.214285714285714, 	 0.357142857142857, 	 0.142857142857143, 	 0.0714285714285714, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0666666666666667, 	 0.0666666666666667, 	 0.2, 	 0.333333333333333, 	 0.0666666666666667, 	 0.133333333333333, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.05, 	 0.05, 	 0.15, 	 0.35, 	 0.35, 	 0.05, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0625, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0.25, 	 0.0625, 	 0.3125, 	 0.0625, 	 0.125, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0416666666666667, 	 0.0833333333333333, 	 0.208333333333333, 	 0.291666666666667, 	 0.125, 	 0.166666666666667, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0.25, 	 0.125, 	 0.25, 	 0.25, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0740740740740741, 	 0.185185185185185, 	 0.296296296296296, 	 0.259259259259259, 	 0, 	 0.185185185185185, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0384615384615385, 	 0.115384615384615, 	 0.307692307692308, 	 0.269230769230769, 	 0.192307692307692, 	 0.0769230769230769, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0588235294117647, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0588235294117647, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.235294117647059, 	 0.176470588235294, 	 0.352941176470588, 	 0.0588235294117647, 	 0.0588235294117647, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0333333333333333, 	 0.0333333333333333, 	 0.0333333333333333, 	 0.0666666666666667, 	 0.2, 	 0.3, 	 0.1, 	 0.133333333333333, 	 0.0666666666666667, 	 0, 	 0.0333333333333333, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.05, 	 0.05, 	 0.15, 	 0.45, 	 0.15, 	 0.05, 	 0.1, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.142857142857143, 	 0.357142857142857, 	 0.142857142857143, 	 0.214285714285714, 	 0, 	 0.142857142857143, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.166666666666667, 	 0.25, 	 0.166666666666667, 	 0.166666666666667, 	 0.25, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0588235294117647, 	 0, 	 0.117647058823529, 	 0.176470588235294, 	 0.294117647058824, 	 0.352941176470588, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0192307692307692, 	 0, 	 0, 	 0, 	 0.0192307692307692, 	 0.134615384615385, 	 0.826923076923077 
    )
    
    mGasolina = matrix(g, nrow = 52, byrow = TRUE)
    
    
    #Valores promedio de los rangos
    pPrecio = c( 0.113491997175776, 	 0.136255067976547, 	 0.16253488979496, 	 0.187728926943442, 	 0.211767205634372, 	 0.236824007610471, 	 0.262352354089778, 	 0.287988975851933, 	 0.313160614209988, 	 0.337899856357368, 	 0.362530762247505, 	 0.387415368650004 )
    pGasolina = c( 0.939909090909091, 	 1.0205, 	 1.0718, 	 1.1004, 	 1.15071428571429, 	 1.18422222222222, 	 1.22613636363636, 	 1.26395238095238, 	 1.30244444444444, 	 1.34415, 	 1.37929032258065, 	 1.42178947368421, 	 1.465, 	 1.50203846153846, 	 1.5403, 	 1.58155172413793, 	 1.62089285714286, 	 1.66794736842105, 	 1.70916666666667, 	 1.74279166666667, 	 1.77991891891892, 	 1.81946153846154, 	 1.86316, 	 1.90443076923077, 	 1.94636231884058, 	 1.98239285714286, 	 2.02392592592593, 	 2.06455, 	 2.10182926829268, 	 2.14472222222222, 	 2.1812, 	 2.22292857142857, 	 2.2588, 	 2.30178571428571, 	 2.34375, 	 2.38605555555556, 	 2.42178947368421, 	 2.45778571428571, 	 2.50106666666667, 	 2.54305, 	 2.5791875, 	 2.62308333333333, 	 2.663125, 	 2.70474074074074, 	 2.74153846153846, 	 2.77841176470588, 	 2.8257, 	 2.86333333333333, 	 2.90107142857143, 	 2.93616666666667, 	 2.98347058823529, 	 3.15819230769231 )
    
    #Estado inicial
    #Precio estado 9
    iPrecio = c(0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0)
    
    #Gasolina estado 21
    iGasolina = c(  0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 1.00, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0 
    )
    
    library(expm)
    
    costo = 0
    Ganancia = 0
    i=1
    f=1
    #Importar parametros de aplicacion
    cantidadRosas = input$cantidadRosas1
    costoProduccion = input$costoProduccion1
    
    #Calculo de las ganancias
    for (i in 1:180) {
      mPrecioE = mPrecio%^%i
      mGasolinaE = mGasolina%^%i
      costoG = (iGasolina%*%mGasolinaE)%*%pGasolina
      utilidad = ((iPrecio%*%mPrecioE)%*%pPrecio)*2000
      
      
      for(f in 1:52){
        R = 0.0125 + (0.0025*(f-1))
        Li = 1 + ((f-1)*0.04)
        Ls = 1 + (f*0.04) 
        
        if(costoG <= 1){
          costoGR = costoG * (1+0.0125)
        }
        
        if(costoG > 3){
          costoGR = costoG * (1+0.14)
        }
        
        if(costoG > Li & costoG <= Ls){
          costoGR = costoG * (1+R)
        }
        
      }
      
      costo = (cantidadRosas*costoProduccion/5) + costoGR
      Ganancia = Ganancia + utilidad - costo
    }
    
    #Genero tabla de resultados
    tablaRes <- data.frame(
      Activo = c("Ganancia"),
      Precio = as.character(c(round(Ganancia,digits = 2))),
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Resultados <- renderTable({
      tablaRes
    })
    
    #Alternativa 1
    valorFuturo = Ganancia * (1+0.62)^52
    valorFuturo
    
    #Genero datos para graficar
    valorFuturo = 0
    
    for( i in 1:52){
      valorFuturo[i] = Ganancia * (1+0.62)^i
    }
    
    #Imprimo grafica
    output$G11 <- renderPlot({
      plot(valorFuturo, xlab = "Semana", ylab = "Ganancia", col = "blue", main = "Pronostico alternativa 1")
    })
    
    #Informacion sobre las graficas
    output$info1 <- renderText({
      xy_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("x=", round(e$x, 1), " y=", round(e$y, 1), "\n")
      }
      xy_range_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("xmin=", round(e$xmin, 1), " xmax=", round(e$xmax, 1), 
               " ymin=", round(e$ymin, 1), " ymax=", round(e$ymax, 1))
      }
      
      paste0(
        "click: ", xy_str(input$plot_click),
        "dblclick: ", xy_str(input$plot_dblclick),
        "hover: ", xy_str(input$plot_hover),
        "brush: ", xy_range_str(input$plot_brush)
      )
      
    })
    
    #Imprimo resultados de la alternativa 1
    tablaED <- data.frame(
      Activo = c("Ganancia alternativa 1"),
      Valor = valorFuturo[52],
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Alt1 <- renderTable({
      tablaED
    })
    
    #Alternativa 2
    #Cargo los datos necesarios para el calculo
    Alt2 = matrix(data = c(3674,	2574,	1694,	3432,	2618,	2299,	2937,	2431,	3432,	2310,	2409,	3762,	1903,	2530,	3366,	2079,	2794,	2321,
                           6680,	4680,	3080,	6240,	4760,	4180,	5340,	4420,	6240,	4200,	4380,	6840,	3460,	4600,	6120,	3780,	5080,	4220,
                           4757.5,	3357.5,	2237.5,	4449.5,	3413.5,	3007.5,	3819.5,	3175.5,	4449.5,	3021.5,	3147.5,	4869.5,	2503.5,	3301.5,	4365.5,	2727.5,	3637.5,	3035.5,
                           297.34375,	209.84375,	139.84375,	266.97,	204.81,	180.45,	238.71875,	198.46875,	278.09375,	188.84375,	196.71875,	304.34375,	156.46875,	206.34375,	272.84375,	170.46875,	227.34375,	189.71875,
                           0.31,	0.31,	0.31,	0.3128257,	0.3128257,	0.3128257,	0.3085936,	0.3085936,	0.3085936,	0.3036594,	0.3036594,	0.3036594,	0.2987579,	0.2987579,	0.2987579,	0.294152,	0.294152,	0.294152,
                           10354,	7254,	4774,	9760.16184,	7445.25166,	6538.05713,	8239.44912,	6819.91856,	9628.12032,	6376.8474,	6650.14086,	10385.15148,	5168.51167,	6871.4317,	9141.99174,	5559.4728,	7471.4608,	6206.6072,
                           0.06,	0.06,	0.06,	0.06647079,	0.06647079,	0.06647079,	0.07144077,	0.07144077,	0.07144077,	0.07361034,	0.07361034,	0.07361034,	0.07456598,	0.07456598,	0.07456598,	0.07498835,	0.07498835,	0.07498835,
                           9732.76,	6818.76,	4487.56,	9111.39617196735,	6950.35990041099,	6103.46730750377,	7650.81653049138,	6332.69832673631,	8940.27999068655,	5907.44549475788,	6160.62173024751,	9620.6969486057,	4783.11653218501,	6359.05666128643,	8460.310166755,	5142.57710785812,	6911.18828251832,	5741.18396697388,
                           8728.84375,	6141.34375,	4071.34375,	8148.47,	6236.31,	5486.95,	6995.21875,	5804.96875,	8159.59375,	5520.34375,	5753.21875,	8935.84375,	4562.96875,	6037.84375,	8004.34375,	4976.96875,	6658.84375,	5546.21875,
                           1003.91625,	677.41625,	416.21625,	962.926171967346,	714.049900410988,	616.517307503766,	655.597780491378,	527.729576736308,	780.686240686553,	387.101744757884,	407.402980247508,	684.853198605697,	220.147782185014,	321.212911286434,	455.966416754996,	165.60835785812,	252.344532518321,	194.965217), nrow=18, ncol=10)
    
    Alt2
    
    #Inicializo variables a usar
    Datos2 = data.frame(Alt2)
    IngresosPropuesta1 = 0
    IngresosPropuesta2 = 0
    IngresosPropuesta3 = 0
    
    #Calculo de las utilidades
    for(j in 0:5){
      IngresosPropuesta1 = IngresosPropuesta1 + Datos2[j*3+1, 8] - Datos2[j*3+1, 9]
      IngresosPropuesta2 = IngresosPropuesta2 + Datos2[j*3+2, 8] - Datos2[j*3+2, 9]
      IngresosPropuesta3 = IngresosPropuesta3 + Datos2[j*3+3, 8] - Datos2[j*3+3, 9]
    }
    #Encuantro la mejor alternativa
    max = 0
    
    if(IngresosPropuesta1>=IngresosPropuesta2){
      max = IngresosPropuesta1
      alternativa = "Alternativa 1"
    }
    
    if(IngresosPropuesta2>=IngresosPropuesta3){
      max = IngresosPropuesta2
      alternativa = "Alternativa 2"
    }
    
    if(IngresosPropuesta3>=IngresosPropuesta1){
      max = IngresosPropuesta3
      alternativa = "Alternativa 3"
    }
    
    #Imprimo grafica
    output$G22 <- renderPlot({
      barplot(height = c(IngresosPropuesta1, IngresosPropuesta2, IngresosPropuesta3), names.arg = c("Alternativa 1", "Alternativa 2", "Alternativa 3"), col = c("blue", "red", "green"), xlab = "Alternativas", ylab = "Ganancias", main = "Alternativa a elegir")
    })
    
    #Informacion sobre las graficas
    output$info2 <- renderText({
      xy_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("x=", round(e$x, 1), " y=", round(e$y, 1), "\n")
      }
      xy_range_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("xmin=", round(e$xmin, 1), " xmax=", round(e$xmax, 1), 
               " ymin=", round(e$ymin, 1), " ymax=", round(e$ymax, 1))
      }
      
      paste0(
        "click: ", xy_str(input$plot_click),
        "dblclick: ", xy_str(input$plot_dblclick),
        "hover: ", xy_str(input$plot_hover),
        "brush: ", xy_range_str(input$plot_brush)
      )
      
    })
    
    #Imprimo tabla de las alternativas
    tablaED1 <- data.frame(
      Activo = c("Alternativa a escoger: "," Ganancias maximas"),
      Valor = c(alternativa, max),
      
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Alt2 <- renderTable({
      tablaED1
    })
    
    tablaED11 <- data.frame(
      stringsAsFactors = FALSE)
    tablaED11
  })
  
  
  #Fase 2
  #
  #
  #
  #
  #
  #
  #Actualizo datos con boton
  observeEvent(input$Actualizar1,{
    
    #Matrices de la CMTD
    p <- c(  0.303030303030303, 	 0.409090909090909, 	 0.166666666666667, 	 0.121212121212121, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
             0.293103448275862, 	 0.344827586206897, 	 0.189655172413793, 	 0.129310344827586, 	 0.0344827586206897, 	 0.00862068965517241, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
             0.0769230769230769, 	 0.259615384615385, 	 0.307692307692308, 	 0.153846153846154, 	 0.163461538461538, 	 0.0384615384615385, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
             0.00943396226415094, 	 0.132075471698113, 	 0.141509433962264, 	 0.254716981132075, 	 0.254716981132075, 	 0.160377358490566, 	 0.0283018867924528, 	 0.00943396226415094, 	 0.00943396226415094, 	 0, 	 0, 	 0, 
             0.0252100840336134, 	 0.0588235294117647, 	 0.109243697478992, 	 0.159663865546218, 	 0.235294117647059, 	 0.235294117647059, 	 0.109243697478992, 	 0.0420168067226891, 	 0.0168067226890756, 	 0.00840336134453781, 	 0, 	 0, 
             0, 	 0.00819672131147541, 	 0.0655737704918033, 	 0.122950819672131, 	 0.180327868852459, 	 0.270491803278689, 	 0.172131147540984, 	 0.147540983606557, 	 0.0327868852459016, 	 0, 	 0, 	 0, 
             0, 	 0, 	 0.029126213592233, 	 0.0388349514563107, 	 0.106796116504854, 	 0.16504854368932, 	 0.223300970873786, 	 0.262135922330097, 	 0.12621359223301, 	 0.0388349514563107, 	 0.00970873786407767, 	 0, 
             0, 	 0, 	 0, 	 0.00675675675675676, 	 0.0675675675675676, 	 0.101351351351351, 	 0.141891891891892, 	 0.283783783783784, 	 0.195945945945946, 	 0.155405405405405, 	 0.0337837837837838, 	 0.0135135135135135, 
             0, 	 0, 	 0, 	 0.00763358778625954, 	 0, 	 0.0381679389312977, 	 0.106870229007634, 	 0.206106870229008, 	 0.282442748091603, 	 0.198473282442748, 	 0.106870229007634, 	 0.0534351145038168, 
             0, 	 0, 	 0, 	 0, 	 0, 	 0.008, 	 0.056, 	 0.152, 	 0.256, 	 0.256, 	 0.184, 	 0.088, 
             0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0114942528735632, 	 0.0919540229885057, 	 0.0804597701149425, 	 0.264367816091954, 	 0.32183908045977, 	 0.229885057471264, 
             0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0138888888888889, 	 0.0833333333333333, 	 0.236111111111111, 	 0.222222222222222, 	 0.444444444444444 
             
    )
    
    mPrecio = matrix(p, nrow = 12, byrow = TRUE)
    
    
    
    g <- c( 0.727272727272727, 	 0.181818181818182, 	 0, 	 0.0909090909090909, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0.25, 	 0, 	 0, 	 0.25, 	 0, 	 0.5, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0.4, 	 0.4, 	 0, 	 0.2, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0.2, 	 0, 	 0.2, 	 0, 	 0.2, 	 0.4, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0.142857142857143, 	 0, 	 0, 	 0.142857142857143, 	 0.285714285714286, 	 0.142857142857143, 	 0.285714285714286, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0.222222222222222, 	 0.111111111111111, 	 0.333333333333333, 	 0.333333333333333, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0.0454545454545455, 	 0.0454545454545455, 	 0.0909090909090909, 	 0.318181818181818, 	 0.318181818181818, 	 0.0909090909090909, 	 0.0909090909090909, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0.0476190476190476, 	 0.0476190476190476, 	 0, 	 0.0476190476190476, 	 0.285714285714286, 	 0.142857142857143, 	 0.238095238095238, 	 0.0952380952380952, 	 0.0952380952380952, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0555555555555556, 	 0.222222222222222, 	 0.277777777777778, 	 0.277777777777778, 	 0.111111111111111, 	 0.0555555555555556, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.1, 	 0.15, 	 0.25, 	 0.15, 	 0.15, 	 0.1, 	 0.05, 	 0.05, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0645161290322581, 	 0.032258064516129, 	 0.0645161290322581, 	 0.0967741935483871, 	 0.451612903225806, 	 0.193548387096774, 	 0.0967741935483871, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0526315789473684, 	 0.0526315789473684, 	 0.157894736842105, 	 0.157894736842105, 	 0.157894736842105, 	 0.210526315789474, 	 0.157894736842105, 	 0, 	 0.0526315789473684, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.294117647058824, 	 0.117647058823529, 	 0, 	 0.294117647058824, 	 0.294117647058824, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0384615384615385, 	 0, 	 0.115384615384615, 	 0.307692307692308, 	 0.307692307692308, 	 0.153846153846154, 	 0.0384615384615385, 	 0.0384615384615385, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.1, 	 0.133333333333333, 	 0.166666666666667, 	 0.233333333333333, 	 0.233333333333333, 	 0.1, 	 0.0333333333333333, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0344827586206897, 	 0.0344827586206897, 	 0.0344827586206897, 	 0.103448275862069, 	 0.137931034482759, 	 0.275862068965517, 	 0.206896551724138, 	 0.0344827586206897, 	 0.137931034482759, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0357142857142857, 	 0.107142857142857, 	 0.214285714285714, 	 0.214285714285714, 	 0.142857142857143, 	 0.107142857142857, 	 0.107142857142857, 	 0.0357142857142857, 	 0, 	 0.0357142857142857, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.105263157894737, 	 0.0526315789473684, 	 0.315789473684211, 	 0.157894736842105, 	 0.315789473684211, 	 0.0526315789473684, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0416666666666667, 	 0.125, 	 0.166666666666667, 	 0.0416666666666667, 	 0.333333333333333, 	 0.125, 	 0.0416666666666667, 	 0.0833333333333333, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0.0833333333333333, 	 0.208333333333333, 	 0.291666666666667, 	 0.25, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.027027027027027, 	 0.0810810810810811, 	 0.027027027027027, 	 0.162162162162162, 	 0.108108108108108, 	 0.297297297297297, 	 0.189189189189189, 	 0.0810810810810811, 	 0.027027027027027, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0512820512820513, 	 0.0256410256410256, 	 0.205128205128205, 	 0.307692307692308, 	 0.205128205128205, 	 0.102564102564103, 	 0.0769230769230769, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0256410256410256, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.02, 	 0, 	 0.04, 	 0.08, 	 0.12, 	 0.26, 	 0.3, 	 0.1, 	 0.04, 	 0.02, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.02, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0153846153846154, 	 0.0923076923076923, 	 0.169230769230769, 	 0.307692307692308, 	 0.246153846153846, 	 0.138461538461538, 	 0.0307692307692308, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0144927536231884, 	 0.0144927536231884, 	 0.072463768115942, 	 0.246376811594203, 	 0.333333333333333, 	 0.217391304347826, 	 0.0869565217391304, 	 0.0144927536231884, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0178571428571429, 	 0, 	 0.0714285714285714, 	 0.107142857142857, 	 0.267857142857143, 	 0.232142857142857, 	 0.178571428571429, 	 0.0714285714285714, 	 0.0535714285714286, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.111111111111111, 	 0.185185185185185, 	 0.407407407407407, 	 0.240740740740741, 	 0.037037037037037, 	 0, 	 0.0185185185185185, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.025, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.025, 	 0.025, 	 0.075, 	 0.225, 	 0.225, 	 0.225, 	 0.1, 	 0.025, 	 0.025, 	 0, 	 0.025, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0731707317073171, 	 0.0975609756097561, 	 0.195121951219512, 	 0.24390243902439, 	 0.24390243902439, 	 0.121951219512195, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.024390243902439, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.111111111111111, 	 0.361111111111111, 	 0.305555555555556, 	 0.138888888888889, 	 0.0277777777777778, 	 0.0277777777777778, 	 0, 	 0.0277777777777778, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0.0333333333333333, 	 0, 	 0.266666666666667, 	 0.433333333333333, 	 0.133333333333333, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0714285714285714, 	 0.142857142857143, 	 0.142857142857143, 	 0.357142857142857, 	 0.214285714285714, 	 0.0714285714285714, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.05, 	 0.1, 	 0.1, 	 0.25, 	 0.15, 	 0.05, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.142857142857143, 	 0, 	 0, 	 0.142857142857143, 	 0.285714285714286, 	 0.285714285714286, 	 0.0714285714285714, 	 0.0714285714285714, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0, 	 0.125, 	 0.25, 	 0.375, 	 0.125, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0555555555555556, 	 0.0555555555555556, 	 0.0555555555555556, 	 0.388888888888889, 	 0.333333333333333, 	 0.0555555555555556, 	 0, 	 0.0555555555555556, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0526315789473684, 	 0.210526315789474, 	 0.368421052631579, 	 0.263157894736842, 	 0.105263157894737, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0714285714285714, 	 0.0714285714285714, 	 0.0714285714285714, 	 0.214285714285714, 	 0.357142857142857, 	 0.142857142857143, 	 0.0714285714285714, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0666666666666667, 	 0.0666666666666667, 	 0.2, 	 0.333333333333333, 	 0.0666666666666667, 	 0.133333333333333, 	 0.0666666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.05, 	 0.05, 	 0.15, 	 0.35, 	 0.35, 	 0.05, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0625, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0.25, 	 0.0625, 	 0.3125, 	 0.0625, 	 0.125, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0416666666666667, 	 0.0833333333333333, 	 0.208333333333333, 	 0.291666666666667, 	 0.125, 	 0.166666666666667, 	 0.0416666666666667, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.125, 	 0.25, 	 0.125, 	 0.25, 	 0.25, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0740740740740741, 	 0.185185185185185, 	 0.296296296296296, 	 0.259259259259259, 	 0, 	 0.185185185185185, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0384615384615385, 	 0.115384615384615, 	 0.307692307692308, 	 0.269230769230769, 	 0.192307692307692, 	 0.0769230769230769, 	 0, 	 0, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0588235294117647, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0588235294117647, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.235294117647059, 	 0.176470588235294, 	 0.352941176470588, 	 0.0588235294117647, 	 0.0588235294117647, 	 0, 	 0, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0333333333333333, 	 0.0333333333333333, 	 0.0333333333333333, 	 0.0666666666666667, 	 0.2, 	 0.3, 	 0.1, 	 0.133333333333333, 	 0.0666666666666667, 	 0, 	 0.0333333333333333, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.05, 	 0.05, 	 0.15, 	 0.45, 	 0.15, 	 0.05, 	 0.1, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.142857142857143, 	 0.357142857142857, 	 0.142857142857143, 	 0.214285714285714, 	 0, 	 0.142857142857143, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.166666666666667, 	 0.25, 	 0.166666666666667, 	 0.166666666666667, 	 0.25, 	 0, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0588235294117647, 	 0, 	 0.117647058823529, 	 0.176470588235294, 	 0.294117647058824, 	 0.352941176470588, 
            0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0, 	 0.0192307692307692, 	 0, 	 0, 	 0, 	 0.0192307692307692, 	 0.134615384615385, 	 0.826923076923077 
    )
    
    mGasolina = matrix(g, nrow = 52, byrow = TRUE)
    
    #Importo los datos de los parametros
    cantidadRosas = input$cantidadRosas
    costoProduccion = input$costoProduccion
    #Calculo valores promedio
    #Se calculan las matrices de trancision
    estadosPrecio <- c("( 0,1 ; 0,125 ]","( 0,125 ; 0,15 ]","( 0,15 ; 0,175 ]","( 0,175 ; 0,2 ]","( 0,2 ; 0,225 ]","( 0,225 ; 0,25 ]","( 0,25 ; 0,275 ]","( 0,275 ; 0,3 ]","( 0,3 ; 0,325 ]","( 0,325 ; 0,35 ]","( 0,35 ; 0,375 ]","( 0,375 ; 0,4 ]")
    cmPrecio <- new(Class="markovchain", states = estadosPrecio, byrow = TRUE,transitionMatrix = mPrecio)
    preciosPromedio  <-matrix(c(0.1125,0.1375,0.1625,0.1875,0.2125,0.2375,0.2625,0.2875,0.3125,0.3375,0.3625,0.3875),nrow =12,byrow = TRUE)
    porcentajeRecargo <- matrix(c(0.0125,0.015,0.0175,0.02,0.0225,0.025,0.0275,0.03,0.0325,0.035,0.0375,0.04,0.0425,0.045,0.0475,0.05,0.0525,0.055,0.0575,0.06,0.0625,0.065,0.0675,0.07,0.0725,0.075,0.0775,0.08,0.0825,0.085,0.0875,0.09,0.0925,0.095,0.0975,0.1,0.1025,0.105,0.1075,0.11,0.1125,0.115,0.1175,0.12,0.1225,0.125,0.1275,0.13,0.1325,0.135,0.1375,0.14),nrow=52,byrow = TRUE)
    nose <- c(0.15,0.35,0.3,0.05,0.05,0.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.178571428571429,0.178571428571429,0.285714285714286,0.178571428571429,0.0357142857142857,0.0357142857142857,0.0714285714285714,0,0.0357142857142857,0,0,0,0,0,0,0,0,0,0,0,0.08,0.16,0.12,0.2,0.16,0.16,0.04,0,0.08,0,0,0,0,0,0,0,0,0,0,0,0.178571428571429,0.0357142857142857,0.0714285714285714,0.142857142857143,0.25,0.142857142857143,0.0714285714285714,0.0357142857142857,0.0357142857142857,0.0357142857142857,0,0,0,0,0,0,0,0,0,0,0.0294117647058824,0.117647058823529,0.0882352941176471,0.117647058823529,0.235294117647059,0.147058823529412,0.117647058823529,0.0882352941176471,0.0294117647058824,0.0294117647058824,0,0,0,0,0,0,0,0,0,0,0.0909090909090909,0.151515151515152,0.0606060606060606,0.121212121212121,0.0606060606060606,0.0606060606060606,0.0909090909090909,0.0909090909090909,0.121212121212121,0.0606060606060606,0.0909090909090909,0,0,0,0,0,0,0,0,0,0,0.111111111111111,0,0.0555555555555556,0.0555555555555556,0.222222222222222,0.111111111111111,0.277777777777778,0.0555555555555556,0.111111111111111,0,0,0,0,0,0,0,0,0,0,0.0333333333333333,0,0.0333333333333333,0.0666666666666667,0.166666666666667,0.166666666666667,0.0333333333333333,0.1,0.166666666666667,0.0666666666666667,0.0666666666666667,0.1,0,0,0,0,0,0,0,0,0,0,0,0.0344827586206897,0.137931034482759,0.103448275862069,0.0344827586206897,0.172413793103448,0.103448275862069,0.206896551724138,0.0344827586206897,0.0689655172413793,0.0344827586206897,0.0689655172413793,0,0,0,0,0,0,0,0,0,0,0,0.04,0.04,0.2,0.12,0.04,0.16,0.16,0.12,0.04,0,0.08,0,0,0,0,0,0,0,0,0,0.08,0.04,0.08,0,0.16,0.08,0.2,0.2,0.08,0.04,0.04,0,0,0,0,0,0,0,0,0.0384615384615385,0,0,0.0384615384615385,0.153846153846154,0.0384615384615385,0.230769230769231,0.0769230769230769,0.115384615384615,0.115384615384615,0.0384615384615385,0.115384615384615,0.0384615384615385,0,0,0,0,0,0,0,0,0,0,0.0333333333333333,0.0666666666666667,0.1,0.0666666666666667,0.0666666666666667,0.1,0.166666666666667,0.1,0.0333333333333333,0.133333333333333,0,0.133333333333333,0,0,0,0,0,0,0,0,0.027027027027027,0.0540540540540541,0.0540540540540541,0.0810810810810811,0.027027027027027,0.108108108108108,0.135135135135135,0.135135135135135,0.162162162162162,0.0810810810810811,0.0810810810810811,0.0540540540540541,0,0,0,0,0,0,0,0,0,0,0,0,0.0909090909090909,0.181818181818182,0.272727272727273,0.0909090909090909,0.0909090909090909,0.0909090909090909,0.136363636363636,0.0454545454545455,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0303030303030303,0.151515151515152,0.181818181818182,0.181818181818182,0.121212121212121,0.212121212121212,0.0606060606060606,0.0606060606060606,0,0,0,0,0,0,0,0,0,0,0.03125,0.03125,0.03125,0.0625,0.03125,0.15625,0.15625,0.15625,0.21875,0.125,0,0,0,0,0,0,0,0,0,0,0.0294117647058824,0.0294117647058824,0.117647058823529,0.117647058823529,0.0294117647058824,0.0882352941176471,0.147058823529412,0.147058823529412,0.205882352941176,0.0882352941176471,0,0,0,0,0,0,0,0,0,0,0,0.0789473684210526,0.0263157894736842,0.0263157894736842,0.0526315789473684,0.0526315789473684,0.157894736842105,0.105263157894737,0.184210526315789,0.315789473684211,0,0,0,0,0,0,0,0,0,0,0,0,0,0.03125,0,0.0625,0.09375,0.21875,0.25,0.34375)
    mLibor <- matrix(nose,nrow=20,byrow=TRUE)
    estadosLibor <- c("0,3-0,33","0,33-0,36","0,36-0,39","0,39-0,42","0,42-0,45","0,45-0,48","0,48-0,51","0,51-0,54","0,54-0,57","0,57-0,6","0,6-0,63","0,63-0,66","0,66-0,69","0,69-0,72","0,72-0,75","0,75-0,78","0,78-0,81","0,81-0,84","0,84-0,87","0,87-0,9")
    cmLibor <- new(Class="markovchain", states = estadosLibor, byrow = TRUE,transitionMatrix = mLibor)
    LiborPromedio <- matrix(c(0.315,0.345,0.375,0.405,0.435,0.465,0.495,0.525,0.555,0.585,0.615,0.645,0.675,0.705,0.735,0.765,0.795,0.825,0.855,0.885),nrow= 20,byrow = TRUE)
    
    
    utilidadDiaria <- function(dia){
      elePRosa <- mPrecio%^%dia
      
      #Se asume el estado inicial de la fase 1
      PRosa <- elePRosa[9,]
      PrecioRosa <- PRosa%*%preciosPromedio
      ganancia <- cantidadRosas*PrecioRosa
      
      elePGasolina <- mGasolina%^%dia
      PGasolina <- elePGasolina[21,]
      PorcentajeGasolina <- PGasolina%*%porcentajeRecargo
      costoTransporte <- (costoProduccion*(0.2*cantidadRosas))*(1+PorcentajeGasolina)
      
      costoProd <- 0.11*cantidadRosas
      
      utilidadDiaria <- ganancia - (costoProd + costoTransporte)
    }
    
    utilidadDelSemestre <- utilidadDiaria(1)*180
    
    #Genero tabla de resultados
    tablaRes <- data.frame(
      Activo = c("Monto inicial"),
      Precio = as.character(c(round(utilidadDelSemestre,digits = 2))),
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Resultados <- renderTable({
      tablaRes
    })
    
    #Alternativa 1
    montoFinalAlt1 <- utilidadDelSemestre
    utilidadPorSemana<-0
    
    for (i in 1:52) {
      elevada <- mLibor%^%i
      tasaLM <- elevada[11,]%*%LiborPromedio
      utilidadPorSemana <- montoFinalAlt1*((tasaLM/100))
      montoFinalAlt1 <- montoFinalAlt1 + utilidadPorSemana
    }
    
    GananciasAlt1 <- montoFinalAlt1 - utilidadDelSemestre
    
    mLiborEE <- steadyStates(cmLibor)
    LiborEE <- mLiborEE%*%LiborPromedio
    LiborEE <- LiborEE/100
    VFalt1 <- GananciasAlt1*((1+LiborEE)^52)
    
    #Genero datos para graficar
    valorFuturo1 = 0
    
    for( i in 1:52){
      valorFuturo1[i] = GananciasAlt1 * (1+0.0062)^i
    }
    
    #Imprimo grafica
    output$G11 <- renderPlot({
      plot(valorFuturo1, xlab = "Semana", ylab = "Ganancia", col = "blue", main = "Pronostico alternativa 1")
    })
    
    #Informacion sobre las graficas
    output$info1 <- renderText({
      xy_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("x=", round(e$x, 1), " y=", round(e$y, 1), "\n")
      }
      xy_range_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("xmin=", round(e$xmin, 1), " xmax=", round(e$xmax, 1), 
               " ymin=", round(e$ymin, 1), " ymax=", round(e$ymax, 1))
      }
      
      paste0(
        "click: ", xy_str(input$plot_click),
        "dblclick: ", xy_str(input$plot_dblclick),
        "hover: ", xy_str(input$plot_hover),
        "brush: ", xy_range_str(input$plot_brush)
      )
      
    })
    
    #Imprimo valores alternativa 1
    tablaED <- data.frame(
      Activo = c("Ganancias con la alternativa 1"),
      Valor = valorFuturo1[52],
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Alt1 <- renderTable({
      tablaED
    })
    
    #Alternativa 2
    
    #Calculo de la tasa inicial al comienzo de la inversion (26 semanas) a partir de la semana presente
    tasaIniInversion <- (mLibor%^%26)[10,]%*%LiborPromedio
    
    #Como el estado esperado de la tasa libor es de 0.622 a la semana 26, este sera nuestro inicial en el rango 11
    #Se hace una nueva matriz con estados absorbentes a partir del maximo de la alt
    mLiborAlt2 <- matrix(c(0.15,0.35,0.3,0.05,0.05,0.1,0,0,0,0,0,0,0,0,0.17857143,0.17857143,0.28571429,0.17857143,0.03571429,0.03571429,0.07142857,0,0.03571429,0,0,0,0,0,0.08,0.16,0.12,0.2,0.16,0.16,0.04,0,0.08,0,0,0,0,0,0.17857143,0.03571429,0.07142857,0.14285714,0.25,0.14285714,0.07142857,0.03571429,0.03571429,0.03571429,0,0,0,0,0.02941176,0.11764706,0.08823529,0.11764706,0.23529412,0.14705882,0.11764706,0.08823529,0.02941176,0.02941176,0,0,0,0,0.09090909,0.15151515,0.06060606,0.12121212,0.06060606,0.06060606,0.09090909,0.09090909,0.12121212,0.06060606,0.09090909,0,0,0,0,0.11111111,0,0.05555556,0.05555556,0.22222222,0.11111111,0.27777778,0.05555556,0.11111111,0,0,0,0,0.03333333,0,0.03333333,0.06666667,0.16666667,0.16666667,0.03333333,0.1,0.16666667,0.06666667,0.06666667,0.1,0,0,0,0,0,0.03448276,0.13793103,0.10344828,0.03448276,0.17241379,0.10344828,0.20689655,0.03448276,0.06896552,0.03448276,0.06896552,0,0,0,0,0,0.04,0.04,0.2,0.12,0.04,0.16,0.16,0.12,0.04,0,0,0,0,0,0.08,0.04,0.08,0,0.16,0.08,0.2,0.2,0.08,0,0,0,0,0.03846154,0,0,0.03846154,0.15384615,0.03846154,0.23076923,0.07692308,0.11538462,0.11538462,0,0,0,0,0,0,0,0.03333333,0.06666667,0.1,0.06666667,0.06666667,0.1,0.16666667,0,0,0,0,0,0,0,0.02702703,0.05405405,0.05405405,0.08108108,0.02702703,0.10810811,0.13513514),nrow=14,byrow = TRUE)
    matrizI2<-diag(nrow(mLiborAlt2))
    
    #Matriz B
    matrizB2<-solve(matrizI2-mLiborAlt2)
    revisionesAntesalt2<-sum(matrizB2[11,])
    
    #Como en la semana 15 a partir del comienzo del tiempo de inversion es que se llega al rango maximo por primera vez,
    #ahi es donde se debe invertir la plata, pues aqui la tasa tomara el valor maximo de 0,735
    montoFinalAlt2 = 0
    GananciasAlt2 = 0
    
    for(i in 1:35){
      montoFinalAlt2[i] <- utilidadDelSemestre*((1+(0.735/100))^i)
      GananciasAlt2[i] <- montoFinalAlt2[i] - utilidadDelSemestre
    }
    
    VFalt2 <- GananciasAlt2[35]
    
    #Imprimo grafica
    output$G22 <- renderPlot({
      plot(GananciasAlt2, xlab = "Semana", ylab = "Ganancia", col = "blue", main = "Pronostico alternativa 2")
    })
    
    #Informacion sobre las graficas
    output$info2 <- renderText({
      xy_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("x=", round(e$x, 1), " y=", round(e$y, 1), "\n")
      }
      xy_range_str <- function(e) {
        if(is.null(e)) return("NULL\n")
        paste0("xmin=", round(e$xmin, 1), " xmax=", round(e$xmax, 1), 
               " ymin=", round(e$ymin, 1), " ymax=", round(e$ymax, 1))
      }
      
      paste0(
        "click: ", xy_str(input$plot_click),
        "dblclick: ", xy_str(input$plot_dblclick),
        "hover: ", xy_str(input$plot_hover),
        "brush: ", xy_range_str(input$plot_brush)
      )
      
    })
    #Imprimo valores alternativa 2
    tablaED1 <- data.frame(
      Activo = c("Ganancias con la alternativa 2"),
      Valor = VFalt2,
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Alt2 <- renderTable({
      tablaED1
    })
    
    #Alternativa 3
    #Para la alternativa 3 se necesita la matriz de los datos de Microsoft
    datosM <- c(0.35,0.2,0.15,0.1,0.1,0,0,0.1,0,0,0,0,0,0,0,0,0,0,0,0,0.235294118,0.058823529,0.117647059,0.058823529,0.235294118,0.058823529,0.117647059,0,0.058823529,0,0.058823529,0,0,0,0,0,0,0,0,0,0.125,0.09375,0.15625,0.15625,0.125,0.09375,0.125,0.125,0,0,0,0,0,0,0,0,0,0,0,0,0.064516129,0.161290323,0.193548387,0.322580645,0.096774194,0.096774194,0.032258065,0,0,0.032258065,0,0,0,0,0,0,0,0,0,0,0.023809524,0.023809524,0.19047619,0.071428571,0.19047619,0.142857143,0.119047619,0.071428571,0.071428571,0.071428571,0,0.023809524,0,0,0,0,0,0,0,0,0,0.096774194,0,0.032258065,0.225806452,0.129032258,0.064516129,0.193548387,0.193548387,0.064516129,0,0,0,0,0,0,0,0,0,0,0.058823529,0,0.117647059,0.088235294,0.058823529,0.147058824,0.235294118,0.058823529,0.058823529,0.029411765,0.117647059,0,0.029411765,0,0,0,0,0,0,0,0,0,0.03030303,0.03030303,0.090909091,0.090909091,0.212121212,0.151515152,0.090909091,0.121212121,0.060606061,0.03030303,0.060606061,0,0.03030303,0,0,0,0,0,0,0,0.032258065,0.096774194,0.129032258,0.032258065,0.032258065,0.161290323,0.161290323,0.096774194,0.032258065,0.096774194,0.064516129,0,0,0.064516129,0,0,0,0,0,0,0,0.029411765,0.058823529,0.029411765,0.029411765,0.117647059,0.058823529,0.117647059,0.147058824,0.058823529,0.147058824,0.088235294,0.058823529,0,0.029411765,0.029411765,0,0,0,0,0.03125,0,0.0625,0.0625,0.0625,0.03125,0.125,0.09375,0.15625,0.0625,0.09375,0.0625,0.09375,0.0625,0,0,0,0,0,0,0,0.043478261,0,0.043478261,0,0,0.130434783,0.130434783,0.130434783,0.086956522,0.043478261,0.130434783,0.086956522,0.130434783,0.043478261,0,0,0,0,0,0,0,0.028571429,0.028571429,0,0,0.028571429,0.171428571,0.085714286,0.114285714,0.085714286,0.2,0.171428571,0.057142857,0.028571429,0,0,0,0,0,0,0,0.024390244,0,0.024390244,0.024390244,0.024390244,0.024390244,0.073170732,0.097560976,0.073170732,0.243902439,0.146341463,0.048780488,0.048780488,0.073170732,0.073170732,0,0,0,0,0,0,0,0,0,0,0.03030303,0.060606061,0.090909091,0.151515152,0.090909091,0.121212121,0.121212121,0.151515152,0.060606061,0.060606061,0.060606061,0,0,0,0,0,0,0,0,0,0.090909091,0.090909091,0.045454545,0,0.181818182,0.136363636,0.136363636,0.090909091,0.090909091,0.045454545,0.090909091,0,0,0,0,0,0,0,0,0,0,0,0,0.222222222,0.222222222,0.055555556,0,0.111111111,0.222222222,0.111111111,0.055555556,0,0,0,0,0,0,0,0,0,0,0.035714286,0,0.107142857,0.071428571,0.107142857,0.071428571,0.071428571,0.142857143,0.071428571,0.321428571,0,0,0,0,0,0,0,0,0,0,0,0,0.157894737,0.157894737,0.105263158,0.052631579,0.052631579,0.368421053,0.052631579,0.052631579,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.043478261,0.043478261,0.217391304,0.347826087,0.347826087)
    mMicrosoft <- matrix(datosM,nrow=20,byrow=TRUE)
    promedioMicrosoft <- matrix(c(71,73,75,77,79,81,83,85,87,89,91,93,95,97,99,101,103,105,107,109),nrow=20,byrow=TRUE)
    
    #Se debe ver en donde esta la accion de microsoft a la semana 26, ya que ahi comienza la inversion
    #El rango inicial en la semana presente es 10
    accionIniM <- (mMicrosoft%^%26)[10,]%*%promedioMicrosoft
    
    #El rango inicial sigue siendo el 88-90
    #Ahora, se debe ver cuanto se demora la accion en bajar al rango optim
    absMCompra <- matrix(c(0.161290322580645,0.0967741935483871,0.032258064516129,0.0967741935483871,0.0645161290322581,0,0,0.0645161290322581,0,0,0,0,0.0588235294117647,0.117647058823529,0.147058823529412,0.0588235294117647,0.147058823529412,0.0882352941176471,0.0588235294117647,0,0.0294117647058824,0.0294117647058824,0,0,0.125,0.09375,0.15625,0.0625,0.09375,0.0625,0.09375,0.0625,0,0,0,0,0.130434782608696,0.130434782608696,0.130434782608696,0.0869565217391304,0.0434782608695652,0.130434782608696,0.0869565217391304,0.130434782608696,0.0434782608695652,0,0,0,0.0285714285714286,0.171428571428571,0.0857142857142857,0.114285714285714,0.0857142857142857,0.2,0.171428571428571,0.0571428571428571,0.0285714285714286,0,0,0,0.024390243902439,0.024390243902439,0.0731707317073171,0.0975609756097561,0.0731707317073171,0.24390243902439,0.146341463414634,0.0487804878048781,0.0487804878048781,0.0731707317073171,0.0731707317073171,0,0,0.0303030303030303,0.0606060606060606,0.0909090909090909,0.151515151515152,0.0909090909090909,0.121212121212121,0.121212121212121,0.151515151515152,0.0606060606060606,0.0606060606060606,0.0606060606060606,0,0.0909090909090909,0.0909090909090909,0.0454545454545455,0,0.181818181818182,0.136363636363636,0.136363636363636,0.0909090909090909,0.0909090909090909,0.0454545454545455,0.0909090909090909,0,0,0,0,0.222222222222222,0.222222222222222,0.0555555555555556,0,0.111111111111111,0.222222222222222,0.111111111111111,0.0555555555555556,0,0,0.0357142857142857,0,0.107142857142857,0.0714285714285714,0.107142857142857,0.0714285714285714,0.0714285714285714,0.142857142857143,0.0714285714285714,0.321428571428571,0,0,0,0,0.157894736842105,0.157894736842105,0.105263157894737,0.0526315789473684,0.0526315789473684,0.368421052631579,0.0526315789473684,0.0526315789473684,0,0,0,0,0,0,0,0.0434782608695652,0.0434782608695652,0.217391304347826,0.347826086956522,0.347826086956522),nrow=12,byrow=TRUE)
    matrizI3<-diag(nrow(absMCompra))
    
    #Matriz B
    matrizB3<-solve(matrizI3-absMCompra)
    tiempoCompra<-sum(matrizB3[2,])
    
    #Segun el resultado, el tiempo en que la accion llegara al rango donde es adecuado comprar es de 9.5 semanas.
    #Ahora, se pasa a ver en cual estado absorbente fue que llego la accion, para ver el valor al que se deberia comprar
    matrizR3 <- matrix(c(0,0,0.032258064516129,0.0967741935483871,0.129032258064516,0.032258064516129,0.032258064516129,0.161290322580645,0,0,0,0.0294117647058824,0.0588235294117647,0.0294117647058824,0.0294117647058824,0.117647058823529,0,0,0.03125,0,0.0625,0.0625,0.0625,0.03125,0,0,0,0.0434782608695652,0,0.0434782608695652,0,0,0,0,0,0,0.0285714285714286,0.0285714285714286,0,0,0,0,0,0,0.024390243902439,0,0.024390243902439,0.024390243902439,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),nrow=12,byrow = TRUE)
    matrizPAbs3 <- matrizB3%*%matrizR3
    
    #Con esta matriz calculada, paso a ver cual es el valor esperado del estado absorbente en el que este
    #Multiplico la fila 2 (88-90) de la PAbs3 con los valores promedios de cada rango
    promAccionCompra <- matrix(c(71,73,75,77,79,81,83,85),nrow =8,byrow = TRUE)
    valorCompraAccion <- matrizPAbs3[2,]%*%promAccionCompra
    
    #El valor esperado al que se comprara la accion es de 81.35158
    #Entonces, en la semana 9, la accion estara en el rango 80-82.
    #Ahora, se pasa a ver en que momento la acci??n llega al rango optimo para la venta
    absMVenta <- matrix(c(0.35,0.2,0.15,0.1,0.1,0,0,0.1,0,0,0,0,0,0,0,0.235294117647059,0.0588235294117647,0.117647058823529,0.0588235294117647,0.235294117647059,0.0588235294117647,0.117647058823529,0,0.0588235294117647,0,0.0588235294117647,0,0,0,0,0.125,0.09375,0.15625,0.15625,0.125,0.09375,0.125,0.125,0,0,0,0,0,0,0,0.0645161290322581,0.161290322580645,0.193548387096774,0.32258064516129,0.0967741935483871,0.0967741935483871,0.032258064516129,0,0,0.032258064516129,0,0,0,0,0,0.0238095238095238,0.0238095238095238,0.19047619047619,0.0714285714285714,0.19047619047619,0.142857142857143,0.119047619047619,0.0714285714285714,0.0714285714285714,0.0714285714285714,0,0.0238095238095238,0,0,0,0,0.0967741935483871,0,0.032258064516129,0.225806451612903,0.129032258064516,0.0645161290322581,0.193548387096774,0.193548387096774,0.0645161290322581,0,0,0,0,0,0.0588235294117647,0,0.117647058823529,0.0882352941176471,0.0588235294117647,0.147058823529412,0.235294117647059,0.0588235294117647,0.0588235294117647,0.0294117647058824,0.117647058823529,0,0.0294117647058824,0,0,0,0,0.0303030303030303,0.0303030303030303,0.0909090909090909,0.0909090909090909,0.212121212121212,0.151515151515152,0.0909090909090909,0.121212121212121,0.0606060606060606,0.0303030303030303,0.0606060606060606,0,0.0303030303030303,0,0,0.032258064516129,0.0967741935483871,0.129032258064516,0.032258064516129,0.032258064516129,0.161290322580645,0.161290322580645,0.0967741935483871,0.032258064516129,0.0967741935483871,0.0645161290322581,0,0,0,0,0,0.0294117647058824,0.0588235294117647,0.0294117647058824,0.0294117647058824,0.117647058823529,0.0588235294117647,0.117647058823529,0.147058823529412,0.0588235294117647,0.147058823529412,0.0882352941176471,0.0588235294117647,0,0,0.03125,0,0.0625,0.0625,0.0625,0.03125,0.125,0.09375,0.15625,0.0625,0.09375,0.0625,0.09375,0,0,0,0.0434782608695652,0,0.0434782608695652,0,0,0.130434782608696,0.130434782608696,0.130434782608696,0.0869565217391304,0.0434782608695652,0.130434782608696,0.0869565217391304,0,0,0,0,0.0285714285714286,0.0285714285714286,0,0,0.0285714285714286,0.171428571428571,0.0857142857142857,0.114285714285714,0.0857142857142857,0.2,0.171428571428571,0,0,0,0,0.024390243902439,0,0.024390243902439,0.024390243902439,0.024390243902439,0.024390243902439,0.0731707317073171,0.0975609756097561,0.0731707317073171,0.24390243902439,0.146341463414634,0,0,0,0,0,0,0,0,0,0.0303030303030303,0.0606060606060606,0.0909090909090909,0.151515151515152,0.0909090909090909,0.121212121212121),nrow=15,byrow=TRUE)
    matrizI4 <- diag(nrow(absMVenta))
    matrizB4 <- solve(matrizI4-absMVenta)
    tiempoVenta <- sum(matrizB4[6,])
    
    #Calculado de esa manera, el tiempo para que la accion llegue al rango para vendera es de 24,27
    tiempoVenta + tiempoCompra
    
    #Hasta el momento van 33.77 semanas de las 52 disponibles.
    #Ahora, se pasa a ver en que rango fue absorbida. El rango al que se compro fue 80-82
    promAccionVenta <- matrix(c(101,103,105,107,109),nrow=5,byrow=TRUE)
    matrizR4 <- matrix(c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0645161290322581,0,0,0,0,0,0.0294117647058824,0.0294117647058824,0,0,0.0625,0,0,0,0,0.130434782608696,0.0434782608695652,0,0,0,0.0571428571428571,0.0285714285714286,0,0,0,0.0487804878048781,0.0487804878048781,0.0731707317073171,0.0731707317073171,0,0.121212121212121,0.151515151515152,0.0606060606060606,0.0606060606060606,0.0606060606060606),nrow=15,byrow=TRUE)
    matrizPAbs4 <- matrizB4%*%matrizR4
    valordeVentaAccion <- matrizPAbs4[6,]%*%promAccionVenta
    accionesCompradas <- utilidadDelSemestre/valorCompraAccion
    ventaAcciones <- accionesCompradas*valordeVentaAccion
    utilidadAlt3 <- ventaAcciones - utilidadDelSemestre
    
    #Imprimo valores alternativa 3
    tablaED2 <- data.frame(
      Activo = c("Ganancias con la alternativa 3"),
      Valor = utilidadAlt3,
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Alt3 <- renderTable({
      tablaED2
    })
    
    alt = c(valorFuturo1[52], VFalt2, utilidadAlt3)
    #Grafica comparativa
    output$G33 <- renderPlot({
      barplot(alt, xlab = "Alternativas", ylab = "Ganancia", col = "blue", main = "Pronostico de las alternativas", names.arg = c("Alternativa 1", "Alternativa 2" , "Alternativa 3"))
    })
    #Tabla comparativa
    tablaED3 <- data.frame(
      Activo = c("Ganancias con la alternativa 1", "Ganancias con la alternativa 2", "Ganancias con la alternativa 3"),
      Valor = c(valorFuturo1[52], VFalt2, utilidadAlt3),
      stringsAsFactors = FALSE)
    
    #Imprimo tabla de resultados
    output$Alt4 <- renderTable({
      tablaED3
    })
    
  })
  

  #Fase 3
  #OPCION FINANCIERA
  #
  #
  #
  #
  #
  #
  output$"Toma de decicion en la alternativa de Finanzas" = renderText({"Toma de decicion en la alternativa de Finanzas"})
  output$contents1 <- renderTable({
    
    #Importo archivo
    req(input$file1)
    inFile <- input$file1
    
    #MatrizPrecioPesos = read_excel(inFile$datapath, sheet = "Hoja1")
    MatrizPrecioPesos =  c(0.204369274,	0.098661029,	0,	0,	0,	0,	0.27589852,	0.133192389,	0,	0,	0,	0,	0.112403101,	0.054263566,	0,	0,	0,	0,	0.08174771,	0.039464412,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.044191919,	0.189393939,	0.069444444,	0,	0,	0,	0.059659091,	0.255681818,	0.09375,	0,	0,	0,	0.024305556,	0.104166667,	0.038194444,	0,	0,	0,	0.017676768,	0.075757576,	0.027777778,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.053475936,	0.160427807,	0.084033613,	0.005092946,	0,	0,	0.072192513,	0.21657754,	0.113445378,	0.006875477,	0,	0,	0.029411765,	0.088235294,	0.046218487,	0.00280112,	0,	0,	0.021390374,	0.064171123,	0.033613445,	0.002037179,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.00199362,	0.063795853,	0.195374801,	0.041866029,	0,	0,	0.002691388,	0.086124402,	0.263755981,	0.056519139,	0,	0,	0.001096491,	0.035087719,	0.10745614,	0.023026316,	0,	0,	0.000797448,	0.025518341,	0.07814992,	0.016746411,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0.002780095,	0.058381985,	0.197386711,	0.044481512,	0,	0,	0.003753128,	0.07881568,	0.26647206,	0.060050042,	0,	0,	0.001529052,	0.032110092,	0.108562691,	0.024464832,	0,	0,	0.001112038,	0.023352794,	0.078954684,	0.017792605,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0.075757576,	0.227272727,	0,	0,	0,	0,	0.102272727,	0.306818182,	0,	0,	0,	0,	0.041666667,	0.125,	0,	0,	0,	0,	0.03030303,	0.090909091,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.197674419,	0.09542903,	0,	0,	0,	0,	0.23255814,	0.112269447,	0,	0,	0,	0,	0.127906977,	0.061748196,	0,	0,	0,	0,	0.087209302,	0.042101043,	0,	0,	0,	0,	0.023255814,	0.011226945,	0,	0,	0,	0,	0.005813953,	0.002806736,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.042744253,	0.183189655,	0.06716954,	0,	0,	0,	0.050287356,	0.215517241,	0.079022989,	0,	0,	0,	0.027658046,	0.118534483,	0.043462644,	0,	0,	0,	0.018857759,	0.080818966,	0.029633621,	0,	0,	0,	0.005028736,	0.021551724,	0.007902299,	0,	0,	0,	0.001257184,	0.005387931,	0.001975575,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.051724138,	0.155172414,	0.081280788,	0.004926108,	0,	0,	0.060851927,	0.182555781,	0.095624457,	0.005795422,	0,	0,	0.03346856,	0.10040568,	0.052593451,	0.003187482,	0,	0,	0.022819473,	0.068458418,	0.035859171,	0.002173283,	0,	0,	0.006085193,	0.018255578,	0.009562446,	0.000579542,	0,	0,	0.001521298,	0.004563895,	0.002390611,	0.000144886,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.001928312,	0.061705989,	0.188974592,	0.040494555,	0,	0,	0.002268603,	0.072595281,	0.222323049,	0.047640653,	0,	0,	0.001247731,	0.039927405,	0.122277677,	0.026202359,	0,	0,	0.000850726,	0.02722323,	0.083371143,	0.017865245,	0,	0,	0.00022686,	0.007259528,	0.022232305,	0.004764065,	0,	0,	0.0000567151,	0.001814882,	0.005558076,	0.001191016,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0.002689022,	0.056469472,	0.190920595,	0.043024359,	0,	0,	0.003163556,	0.066434673,	0.224612464,	0.050616893,	0,	0,	0.001739956,	0.03653907,	0.123536855,	0.027839291,	0,	0,	0.001186333,	0.024913002,	0.084229674,	0.018981335,	0,	0,	0.000316356,	0.006643467,	0.022461246,	0.005061689,	0,	0,	0.0000790889,	0.001660867,	0.005615312,	0.001265422,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0.073275862,	0.219827586,	0,	0,	0,	0,	0.086206897,	0.25862069,	0,	0,	0,	0,	0.047413793,	0.142241379,	0,	0,	0,	0,	0.032327586,	0.096982759,	0,	0,	0,	0,	0.00862069,	0.025862069,	0,	0,	0,	0,	0.002155172,	0.006465517,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.051878354,	0.025044723,	0,	0,	0,	0,	0.175089445,	0.084525939,	0,	0,	0,	0,	0.207513417,	0.100178891,	0,	0,	0,	0,	0.103756708,	0.050089445,	0,	0,	0,	0,	0.110241503,	0.053220036,	0,	0,	0,	0,	0.025939177,	0.012522361,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.011217949,	0.048076923,	0.017628205,	0,	0,	0,	0.037860577,	0.162259615,	0.059495192,	0,	0,	0,	0.044871795,	0.192307692,	0.070512821,	0,	0,	0,	0.022435897,	0.096153846,	0.03525641,	0,	0,	0,	0.023838141,	0.102163462,	0.037459936,	0,	0,	0,	0.005608974,	0.024038462,	0.008814103,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.013574661,	0.040723982,	0.02133161,	0.001292825,	0,	0,	0.04581448,	0.137443439,	0.071994182,	0.004363284,	0,	0,	0.054298643,	0.162895928,	0.085326438,	0.005171299,	0,	0,	0.027149321,	0.081447964,	0.042663219,	0.00258565,	0,	0,	0.028846154,	0.086538462,	0.04532967,	0.002747253,	0,	0,	0.00678733,	0.020361991,	0.010665805,	0.000646412,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.000506073,	0.016194332,	0.049595142,	0.01062753,	0,	0,	0.001707996,	0.05465587,	0.167383603,	0.035867915,	0,	0,	0.002024291,	0.064777328,	0.198380567,	0.042510121,	0,	0,	0.001012146,	0.032388664,	0.099190283,	0.021255061,	0,	0,	0.001075405,	0.034412955,	0.105389676,	0.022583502,	0,	0,	0.000253036,	0.008097166,	0.024797571,	0.005313765,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0.000705716,	0.014820042,	0.050105857,	0.011291461,	0,	0,	0.002381793,	0.050017643,	0.169107269,	0.03810868,	0,	0,	0.002822865,	0.059280169,	0.20042343,	0.045165843,	0,	0,	0.001411433,	0.029640085,	0.100211715,	0.022582922,	0,	0,	0.001499647,	0.03149259,	0.106474947,	0.023994354,	0,	0,	0.000352858,	0.007410021,	0.025052929,	0.00564573,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0.019230769,	0.057692308,	0,	0,	0,	0,	0.064903846,	0.194711538,	0,	0,	0,	0,	0.076923077,	0.230769231,	0,	0,	0,	0,	0.038461538,	0.115384615,	0,	0,	0,	0,	0.040865385,	0.122596154,	0,	0,	0,	0,	0.009615385,	0.028846154,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.00636244,	0.003071523,	0,	0,	0,	0,	0.089074155,	0.043001316,	0,	0,	0,	0,	0.095436595,	0.046072839,	0,	0,	0,	0,	0.171785871,	0.08293111,	0,	0,	0,	0,	0.171785871,	0.08293111,	0,	0,	0,	0,	0.108161474,	0.052215884,	0,	0,	0,	0,	0.019087319,	0.009214568,	0,	0,	0,	0,	0.00636244,	0.003071523,	0,	0,	0,	0,	0.00636244,	0.003071523,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.001375786,	0.005896226,	0.00216195,	0,	0,	0,	0.019261006,	0.08254717,	0.030267296,	0,	0,	0,	0.020636792,	0.088443396,	0.032429245,	0,	0,	0,	0.037146226,	0.159198113,	0.058372642,	0,	0,	0,	0.037146226,	0.159198113,	0.058372642,	0,	0,	0,	0.023388365,	0.100235849,	0.036753145,	0,	0,	0,	0.004127358,	0.017688679,	0.006485849,	0,	0,	0,	0.001375786,	0.005896226,	0.00216195,	0,	0,	0,	0.001375786,	0.005896226,	0.00216195,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.001664817,	0.004994451,	0.002616141,	0.000158554,	0,	0,	0.023307436,	0.069922309,	0.036625971,	0.002219756,	0,	0,	0.024972253,	0.074916759,	0.039242112,	0.00237831,	0,	0,	0.044950055,	0.134850166,	0.070635801,	0.004280958,	0,	0,	0.044950055,	0.134850166,	0.070635801,	0.004280958,	0,	0,	0.028301887,	0.08490566,	0.044474394,	0.002695418,	0,	0,	0.004994451,	0.014983352,	0.007848422,	0.000475662,	0,	0,	0.001664817,	0.004994451,	0.002616141,	0.000158554,	0,	0,	0.001664817,	0.004994451,	0.002616141,	0.000158554,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.0000620655,	0.001986097,	0.006082423,	0.001303376,	0,	0,	0.000868918,	0.027805362,	0.085153923,	0.018247269,	0,	0,	0.000930983,	0.02979146,	0.091236346,	0.019550645,	0,	0,	0.00167577,	0.053624628,	0.164225422,	0.035191162,	0,	0,	0.00167577,	0.053624628,	0.164225422,	0.035191162,	0,	0,	0.001055114,	0.033763654,	0.103401192,	0.022157398,	0,	0,	0.000186197,	0.005958292,	0.018247269,	0.003910129,	0,	0,	0.0000620655,	0.001986097,	0.006082423,	0.001303376,	0,	0,	0.0000620655,	0.001986097,	0.006082423,	0.001303376,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0.0000865501,	0.001817552,	0.006145058,	0.001384802,	0,	0,	0.001211702,	0.025445733,	0.086030812,	0.019387225,	0,	0,	0.001298252,	0.027263285,	0.09217587,	0.020772027,	0,	0,	0.002336853,	0.049073914,	0.165916566,	0.037389649,	0,	0,	0.002336853,	0.049073914,	0.165916566,	0.037389649,	0,	0,	0.001471352,	0.03089839,	0.104465986,	0.023541631,	0,	0,	0.00025965,	0.005452657,	0.018435174,	0.004154405,	0,	0,	0.0000865501,	0.001817552,	0.006145058,	0.001384802,	0,	0,	0.0000865501,	0.001817552,	0.006145058,	0.001384802,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0.002358491,	0.007075472,	0,	0,	0,	0,	0.033018868,	0.099056604,	0,	0,	0,	0,	0.035377358,	0.106132075,	0,	0,	0,	0,	0.063679245,	0.191037736,	0,	0,	0,	0,	0.063679245,	0.191037736,	0,	0,	0,	0,	0.04009434,	0.120283019,	0,	0,	0,	0,	0.007075472,	0.021226415,	0,	0,	0,	0,	0.002358491,	0.007075472,	0,	0,	0,	0,	0.002358491,	0.007075472,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.01700215,	0.008207934,	0,	0,	0,	0,	0.039671683,	0.019151847,	0,	0,	0,	0,	0.073675982,	0.035567715,	0,	0,	0,	0,	0.107680281,	0.051983584,	0,	0,	0,	0,	0.158686731,	0.076607387,	0,	0,	0,	0,	0.158686731,	0.076607387,	0,	0,	0,	0,	0.073675982,	0.035567715,	0,	0,	0,	0,	0.028336916,	0.013679891,	0,	0,	0,	0,	0.011334766,	0.005471956,	0,	0,	0,	0,	0.005667383,	0.002735978,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0.003676471,	0.015756303,	0.005777311,	0,	0,	0,	0.008578431,	0.036764706,	0.013480392,	0,	0,	0,	0.015931373,	0.068277311,	0.025035014,	0,	0,	0,	0.023284314,	0.099789916,	0.036589636,	0,	0,	0,	0.034313725,	0.147058824,	0.053921569,	0,	0,	0,	0.034313725,	0.147058824,	0.053921569,	0,	0,	0,	0.015931373,	0.068277311,	0.025035014,	0,	0,	0,	0.006127451,	0.026260504,	0.009628852,	0,	0,	0,	0.00245098,	0.010504202,	0.003851541,	0,	0,	0,	0.00122549,	0.005252101,	0.00192577,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.004448838,	0.013346515,	0.006991032,	0.000423699,	0,	0,	0.010380623,	0.031141869,	0.016312407,	0.000988631,	0,	0,	0.0192783,	0.057834899,	0.030294471,	0.001836029,	0,	0,	0.028175976,	0.084527929,	0.044276534,	0.002683426,	0,	0,	0.041522491,	0.124567474,	0.065249629,	0.003954523,	0,	0,	0.041522491,	0.124567474,	0.065249629,	0.003954523,	0,	0,	0.0192783,	0.057834899,	0.030294471,	0.001836029,	0,	0,	0.007414731,	0.022244192,	0.01165172,	0.000706165,	0,	0,	0.002965892,	0.008897677,	0.004660688,	0.000282466,	0,	0,	0.001482946,	0.004448838,	0.002330344,	0.000141233,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0.000165856,	0.005307386,	0.01625387,	0.003482972,	0,	0,	0.000386997,	0.012383901,	0.037925697,	0.008126935,	0,	0,	0.000718709,	0.022998673,	0.070433437,	0.015092879,	0,	0,	0.00105042,	0.033613445,	0.102941176,	0.022058824,	0,	0,	0.001547988,	0.049535604,	0.151702786,	0.03250774,	0,	0,	0.001547988,	0.049535604,	0.151702786,	0.03250774,	0,	0,	0.000718709,	0.022998673,	0.070433437,	0.015092879,	0,	0,	0.000276426,	0.008845644,	0.027089783,	0.005804954,	0,	0,	0.000110571,	0.003538257,	0.010835913,	0.002321981,	0,	0,	0.0000552853,	0.001769129,	0.005417957,	0.001160991,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0.000231285,	0.004856989,	0.016421247,	0.003700563,	0,	0,	0.000539665,	0.011332974,	0.038316244,	0.008634647,	0,	0,	0.001002236,	0.021046951,	0.071158739,	0.016035772,	0,	0,	0.001464806,	0.030760928,	0.104001234,	0.023436898,	0,	0,	0.002158662,	0.045331894,	0.153264976,	0.034538586,	0,	0,	0.002158662,	0.045331894,	0.153264976,	0.034538586,	0,	0,	0.001002236,	0.021046951,	0.071158739,	0.016035772,	0,	0,	0.000385475,	0.008094981,	0.027368746,	0.006167605,	0,	0,	0.00015419,	0.003237992,	0.010947498,	0.002467042,	0,	0,	0.0000770951,	0.001618996,	0.005473749,	0.001233521,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0.006302521,	0.018907563,	0,	0,	0,	0,	0.014705882,	0.044117647,	0,	0,	0,	0,	0.027310924,	0.081932773,	0,	0,	0,	0,	0.039915966,	0.119747899,	0,	0,	0,	0,	0.058823529,	0.176470588,	0,	0,	0,	0,	0.058823529,	0.176470588,	0,	0,	0,	0,	0.027310924,	0.081932773,	0,	0,	0,	0,	0.010504202,	0.031512605,	0,	0,	0,	0,	0.004201681,	0.012605042,	0,	0,	0,	0,	0.00210084,	0.006302521,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0.005528021,	0.0026687,	0,	0,	0,	0,	0.044224171,	0.0213496,	0,	0,	0,	0,	0.08292032,	0.040030499,	0,	0,	0,	0,	0.12161647,	0.058711399,	0,	0,	0,	0,	0.182424705,	0.088067099,	0,	0,	0,	0,	0.116088448,	0.056042699,	0,	0,	0,	0,	0.099504384,	0.048036599,	0,	0,	0,	0,	0.022112085,	0.0106748,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0.001195355,	0.005122951,	0.001878415,	0,	0,	0,	0.009562842,	0.040983607,	0.015027322,	0,	0,	0,	0.017930328,	0.076844262,	0.02817623,	0,	0,	0,	0.026297814,	0.112704918,	0.041325137,	0,	0,	0,	0.039446721,	0.169057377,	0.061987705,	0,	0,	0,	0.025102459,	0.107581967,	0.039446721,	0,	0,	0,	0.021516393,	0.092213115,	0.033811475,	0,	0,	0,	0.004781421,	0.020491803,	0.007513661,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0.00144648,	0.004339441,	0.00227304,	0.00013776,	0,	0,	0.011571842,	0.034715526,	0.018184323,	0.00110208,	0,	0,	0.021697203,	0.06509161,	0.034095605,	0.0020664,	0,	0,	0.031822565,	0.095467695,	0.050006888,	0.00303072,	0,	0,	0.047733848,	0.143201543,	0.075010332,	0.004546081,	0,	0,	0.030376085,	0.091128255,	0.047733848,	0.00289296,	0,	0,	0.026036644,	0.078109932,	0.040914727,	0.00247968,	0,	0,	0.005785921,	0.017357763,	0.009092161,	0.00055104,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0.0000539258,	0.001725626,	0.005284728,	0.001132442,	0,	0,	0.000431406,	0.013805004,	0.042277826,	0.009059534,	0,	0,	0.000808887,	0.025884383,	0.079270923,	0.016986626,	0,	0,	0.001186368,	0.037963762,	0.116264021,	0.024913719,	0,	0,	0.001779551,	0.056945643,	0.174396031,	0.037370578,	0,	0,	0.001132442,	0.036238136,	0.110979292,	0.023781277,	0,	0,	0.000970664,	0.03106126,	0.095125108,	0.020383952,	0,	0,	0.000215703,	0.006902502,	0.021138913,	0.004529767,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0.0000751993,	0.001579185,	0.005339149,	0.001203188,	0,	0,	0.000601594,	0.012633479,	0.04271319,	0.009625508,	0,	0,	0.001127989,	0.023687773,	0.080087231,	0.018047827,	0,	0,	0.001654384,	0.034742066,	0.117461272,	0.026470146,	0,	0,	0.002481576,	0.0521131,	0.176191909,	0.039705219,	0,	0,	0.001579185,	0.033162882,	0.112122124,	0.025266957,	0,	0,	0.001353587,	0.028425327,	0.096104677,	0.021657392,	0,	0,	0.000300797,	0.006316739,	0.021356595,	0.004812754,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.00204918,	0.006147541,	0,	0,	0,	0,	0.016393443,	0.049180328,	0,	0,	0,	0,	0.030737705,	0.092213115,	0,	0,	0,	0,	0.045081967,	0.135245902,	0,	0,	0,	0,	0.067622951,	0.202868852,	0,	0,	0,	0,	0.043032787,	0.129098361,	0,	0,	0,	0,	0.036885246,	0.110655738,	0,	0,	0,	0,	0.008196721,	0.024590164,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.01964326,	0.009482953,	0,	0,	0,	0,	0.026191014,	0.012643938,	0,	0,	0,	0,	0.072025288,	0.034770829,	0,	0,	0,	0,	0.111311809,	0.053736735,	0,	0,	0,	0,	0.150598329,	0.072702642,	0,	0,	0,	0,	0.176789343,	0.085346579,	0,	0,	0,	0,	0.085120795,	0.041092797,	0,	0,	0,	0,	0.026191014,	0.012643938,	0,	0,	0,	0,	0.006547753,	0.003160984,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.004247573,	0.018203883,	0.006674757,	0,	0,	0,	0.00566343,	0.024271845,	0.008899676,	0,	0,	0,	0.015574434,	0.066747573,	0.02447411,	0,	0,	0,	0.024069579,	0.10315534,	0.037823625,	0,	0,	0,	0.032564725,	0.139563107,	0.051173139,	0,	0,	0,	0.038228155,	0.163834951,	0.060072816,	0,	0,	0,	0.018406149,	0.078883495,	0.028923948,	0,	0,	0,	0.00566343,	0.024271845,	0.008899676,	0,	0,	0,	0.001415858,	0.006067961,	0.002224919,	0,	0,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.00513992,	0.01541976,	0.008077017,	0.000489516,	0,	0,	0.006853227,	0.02055968,	0.010769356,	0.000652688,	0,	0,	0.018846374,	0.056539121,	0.02961573,	0.001794893,	0,	0,	0.029126214,	0.087378641,	0.045769764,	0.002773925,	0,	0,	0.039406054,	0.118218161,	0.061923799,	0.003752957,	0,	0,	0.04625928,	0.138777841,	0.072693155,	0.004405646,	0,	0,	0.022272987,	0.066818961,	0.035000408,	0.002121237,	0,	0,	0.006853227,	0.02055968,	0.010769356,	0.000652688,	0,	0,	0.001713307,	0.00513992,	0.002692339,	0.000163172,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.00019162,	0.006131834,	0.018778743,	0.004024016,	0,	0,	0.000255493,	0.008175779,	0.025038324,	0.005365355,	0,	0,	0.000702606,	0.022483393,	0.068855391,	0.014754727,	0,	0,	0.001085846,	0.034747062,	0.106412877,	0.022802759,	0,	0,	0.001469085,	0.047010731,	0.143970363,	0.030850792,	0,	0,	0.001724578,	0.05518651,	0.169008687,	0.036216147,	0,	0,	0.000830353,	0.026571283,	0.081374553,	0.017437404,	0,	0,	0.000255493,	0.008175779,	0.025038324,	0.005365355,	0,	0,	0.0000638733,	0.002043945,	0.006259581,	0.001341339,	0,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.000267213,	0.005611472,	0.018972121,	0.004275407,	0,	0,	0.000356284,	0.007481963,	0.025296161,	0.005700543,	0,	0,	0.000979781,	0.020575399,	0.069564443,	0.015676494,	0,	0,	0.001514207,	0.031798343,	0.107508684,	0.024227309,	0,	0,	0.002048633,	0.043021288,	0.145452926,	0.032778124,	0,	0,	0.002404917,	0.050503251,	0.170749087,	0.038478667,	0,	0,	0.001157923,	0.02431638,	0.082212523,	0.018526766,	0,	0,	0.000356284,	0.007481963,	0.025296161,	0.005700543,	0,	0,	0.000089071,	0.001870491,	0.00632404,	0.001425136,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.007281553,	0.02184466,	0,	0,	0,	0,	0.009708738,	0.029126214,	0,	0,	0,	0,	0.026699029,	0.080097087,	0,	0,	0,	0,	0.041262136,	0.123786408,	0,	0,	0,	0,	0.055825243,	0.167475728,	0,	0,	0,	0,	0.065533981,	0.196601942,	0,	0,	0,	0,	0.031553398,	0.094660194,	0,	0,	0,	0,	0.009708738,	0.029126214,	0,	0,	0,	0,	0.002427184,	0.007281553,	0,	0,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.004556882,	0.002199874,	0,	0,	0,	0,	0.045568825,	0.021998743,	0,	0,	0,	0,	0.068353237,	0.032998114,	0,	0,	0,	0,	0.095694532,	0.04619736,	0,	0,	0,	0,	0.191389063,	0.09239472,	0,	0,	0,	0,	0.132149591,	0.063796354,	0,	0,	0,	0,	0.104808297,	0.050597109,	0,	0,	0,	0,	0.022784412,	0.010999371,	0,	0,	0,	0,	0.009113765,	0.004399749,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.00098536,	0.004222973,	0.001548423,	0,	0,	0,	0.009853604,	0.04222973,	0.015484234,	0,	0,	0,	0.014780405,	0.063344595,	0.023226351,	0,	0,	0,	0.020692568,	0.088682432,	0.032516892,	0,	0,	0,	0.041385135,	0.177364865,	0.065033784,	0,	0,	0,	0.02857545,	0.122466216,	0.044904279,	0,	0,	0,	0.022663288,	0.097128378,	0.035613739,	0,	0,	0,	0.004926802,	0.021114865,	0.007742117,	0,	0,	0,	0.001970721,	0.008445946,	0.003096847,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001192369,	0.003577107,	0.001873722,	0.000113559,	0,	0,	0.011923688,	0.035771065,	0.018737225,	0.001135589,	0,	0,	0.017885533,	0.053656598,	0.028105837,	0.001703384,	0,	0,	0.025039746,	0.075119237,	0.039348172,	0.002384738,	0,	0,	0.050079491,	0.150238474,	0.078696343,	0.004769475,	0,	0,	0.034578696,	0.103736089,	0.054337951,	0.003293209,	0,	0,	0.027424483,	0.08227345,	0.043095617,	0.002611856,	0,	0,	0.005961844,	0.017885533,	0.009368612,	0.000567795,	0,	0,	0.002384738,	0.007154213,	0.003747445,	0.000227118,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.0000444523,	0.001422475,	0.00435633,	0.000933499,	0,	0,	0.000444523,	0.014224751,	0.0435633,	0.009334993,	0,	0,	0.000666785,	0.021337127,	0.06534495,	0.014002489,	0,	0,	0.000933499,	0.029871977,	0.09148293,	0.019603485,	0,	0,	0.001866999,	0.059743954,	0.182965861,	0.03920697,	0,	0,	0.001289118,	0.041251778,	0.12633357,	0.027071479,	0,	0,	0.001022404,	0.032716927,	0.10019559,	0.021470484,	0,	0,	0.000222262,	0.007112376,	0.02178165,	0.004667496,	0,	0,	0.0000889047,	0.00284495,	0.00871266,	0.001866999,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.0000619886,	0.00130176,	0.00440119,	0.000991818,	0,	0,	0.000619886,	0.013017605,	0.044011902,	0.009918175,	0,	0,	0.000929829,	0.019526407,	0.066017853,	0.014877263,	0,	0,	0.00130176,	0.02733697,	0.092424994,	0.020828168,	0,	0,	0.002603521,	0.05467394,	0.184849988,	0.041656335,	0,	0,	0.001797669,	0.037751054,	0.127634515,	0.028762708,	0,	0,	0.001425738,	0.029940491,	0.101227374,	0.022811803,	0,	0,	0.000309943,	0.006508802,	0.022005951,	0.004959088,	0,	0,	0.000123977,	0.002603521,	0.00880238,	0.001983635,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001689189,	0.005067568,	0,	0,	0,	0,	0.016891892,	0.050675676,	0,	0,	0,	0,	0.025337838,	0.076013514,	0,	0,	0,	0,	0.035472973,	0.106418919,	0,	0,	0,	0,	0.070945946,	0.212837838,	0,	0,	0,	0,	0.048986486,	0.146959459,	0,	0,	0,	0,	0.038851351,	0.116554054,	0,	0,	0,	0,	0.008445946,	0.025337838,	0,	0,	0,	0,	0.003378378,	0.010135135,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.005148234,	0.002485354,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.025741168,	0.012426771,	0,	0,	0,	0,	0.072075271,	0.034794958,	0,	0,	0,	0,	0.139002308,	0.067104562,	0,	0,	0,	0,	0.190484644,	0.091958104,	0,	0,	0,	0,	0.133854074,	0.064619208,	0,	0,	0,	0,	0.072075271,	0.034794958,	0,	0,	0,	0,	0.036037635,	0.017397479,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001113232,	0.004770992,	0.001749364,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.005566158,	0.023854962,	0.008746819,	0,	0,	0,	0.015585242,	0.066793893,	0.024491094,	0,	0,	0,	0.030057252,	0.128816794,	0.047232824,	0,	0,	0,	0.041189567,	0.176526718,	0.064726463,	0,	0,	0,	0.02894402,	0.124045802,	0.045483461,	0,	0,	0,	0.015585242,	0.066793893,	0.024491094,	0,	0,	0,	0.007792621,	0.033396947,	0.012245547,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001347104,	0.004041311,	0.002116877,	0.000128296,	0,	0,	0,	0,	0,	0,	0,	0,	0.006735519,	0.020206556,	0.010584386,	0.000641478,	0,	0,	0.018859452,	0.056578357,	0.029636282,	0.001796138,	0,	0,	0.036371801,	0.109115402,	0.057155687,	0.003463981,	0,	0,	0.049842838,	0.149528514,	0.07832446,	0.004746937,	0,	0,	0.035024697,	0.105074091,	0.055038809,	0.003335685,	0,	0,	0.018859452,	0.056578357,	0.029636282,	0.001796138,	0,	0,	0.009429726,	0.028289178,	0.014818141,	0.000898069,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.000050221,	0.001607071,	0.004921655,	0.00105464,	0,	0,	0,	0,	0,	0,	0,	0,	0.000251105,	0.008035356,	0.024608276,	0.005273202,	0,	0,	0.000703094,	0.022498996,	0.068903174,	0.014764966,	0,	0,	0.001355966,	0.04339092,	0.132884693,	0.028475291,	0,	0,	0.001858176,	0.059461631,	0.182101245,	0.039021695,	0,	0,	0.001305745,	0.041783849,	0.127963037,	0.027420651,	0,	0,	0.000703094,	0.022498996,	0.068903174,	0.014764966,	0,	0,	0.000351547,	0.011249498,	0.034451587,	0.007382483,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.0000700329,	0.001470691,	0.004972337,	0.001120527,	0,	0,	0,	0,	0,	0,	0,	0,	0.000350165,	0.007353456,	0.024861685,	0.005602633,	0,	0,	0.000980461,	0.020589677,	0.069612718,	0.015687373,	0,	0,	0.001890889,	0.039708663,	0.134253099,	0.030254219,	0,	0,	0.002591218,	0.054415575,	0.183976469,	0.041459486,	0,	0,	0.001820856,	0.038237972,	0.129280762,	0.029133693,	0,	0,	0.000980461,	0.020589677,	0.069612718,	0.015687373,	0,	0,	0.00049023,	0.010294839,	0.034806359,	0.007843687,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001908397,	0.005725191,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.009541985,	0.028625954,	0,	0,	0,	0,	0.026717557,	0.080152672,	0,	0,	0,	0,	0.051526718,	0.154580153,	0,	0,	0,	0,	0.070610687,	0.211832061,	0,	0,	0,	0,	0.049618321,	0.148854962,	0,	0,	0,	0,	0.026717557,	0.080152672,	0,	0,	0,	0,	0.013358779,	0.040076336,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.005395349,	0.002604651,	0,	0,	0,	0,	0.037767442,	0.018232558,	0,	0,	0,	0,	0.102511628,	0.049488372,	0,	0,	0,	0,	0.172651163,	0.083348837,	0,	0,	0,	0,	0.172651163,	0.083348837,	0,	0,	0,	0,	0.124093023,	0.059906977,	0,	0,	0,	0,	0.059348837,	0.028651163,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001166667,	0.005,	0.001833333,	0,	0,	0,	0.008166667,	0.035,	0.012833333,	0,	0,	0,	0.022166667,	0.095,	0.034833333,	0,	0,	0,	0.037333333,	0.16,	0.058666667,	0,	0,	0,	0.037333333,	0.16,	0.058666667,	0,	0,	0,	0.026833333,	0.115,	0.042166667,	0,	0,	0,	0.012833333,	0.055,	0.020166667,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001411765,	0.004235294,	0.002218487,	0.000134454,	0,	0,	0.009882353,	0.029647059,	0.015529412,	0.000941176,	0,	0,	0.026823529,	0.080470588,	0.042151261,	0.002554622,	0,	0,	0.045176471,	0.135529412,	0.070991597,	0.004302521,	0,	0,	0.045176471,	0.135529412,	0.070991597,	0.004302521,	0,	0,	0.032470588,	0.097411765,	0.05102521,	0.003092437,	0,	0,	0.015529412,	0.046588235,	0.024403361,	0.001478992,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.0000526316,	0.001684211,	0.005157895,	0.001105263,	0,	0,	0.000368421,	0.011789474,	0.036105263,	0.007736842,	0,	0,	0.001,	0.032,	0.098,	0.021,	0,	0,	0.001684211,	0.053894737,	0.165052632,	0.035368421,	0,	0,	0.001684211,	0.053894737,	0.165052632,	0.035368421,	0,	0,	0.001210526,	0.038736842,	0.118631579,	0.025421053,	0,	0,	0.000578947,	0.018526316,	0.056736842,	0.012157895,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.0000733945,	0.001541284,	0.005211009,	0.001174312,	0,	0,	0.000513761,	0.010788991,	0.036477064,	0.008220183,	0,	0,	0.001394495,	0.029284404,	0.099009174,	0.022311927,	0,	0,	0.002348624,	0.049321101,	0.166752294,	0.037577982,	0,	0,	0.002348624,	0.049321101,	0.166752294,	0.037577982,	0,	0,	0.001688073,	0.035449541,	0.119853211,	0.027009174,	0,	0,	0.000807339,	0.016954128,	0.057321101,	0.012917431,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.002,	0.006,	0,	0,	0,	0,	0.014,	0.042,	0,	0,	0,	0,	0.038,	0.114,	0,	0,	0,	0,	0.064,	0.192,	0,	0,	0,	0,	0.064,	0.192,	0,	0,	0,	0,	0.046,	0.138,	0,	0,	0,	0,	0.022,	0.066,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.007751938,	0.003742315,	0,	0,	0,	0,	0.062015504,	0.029938519,	0,	0,	0,	0,	0.054263566,	0.026196204,	0,	0,	0,	0,	0.178294574,	0.086073242,	0,	0,	0,	0,	0.217054264,	0.104784817,	0,	0,	0,	0,	0.15503876,	0.074846298,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.001676245,	0.007183908,	0.0026341,	0,	0,	0,	0.013409962,	0.057471264,	0.021072797,	0,	0,	0,	0.011733716,	0.050287356,	0.018438697,	0,	0,	0,	0.03855364,	0.165229885,	0.060584291,	0,	0,	0,	0.046934866,	0.201149425,	0.073754789,	0,	0,	0,	0.033524904,	0.143678161,	0.052681992,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.002028398,	0.006085193,	0.003187482,	0.000193181,	0,	0,	0.016227181,	0.048681542,	0.025499855,	0.001545446,	0,	0,	0.014198783,	0.042596349,	0.022312373,	0.001352265,	0,	0,	0.046653144,	0.139959432,	0.073312083,	0.004443157,	0,	0,	0.056795132,	0.170385396,	0.089249493,	0.00540906,	0,	0,	0.040567951,	0.121703854,	0.063749638,	0.003863614,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.0000756201,	0.002419843,	0.007410768,	0.001588022,	0,	0,	0.000604961,	0.019358742,	0.059286146,	0.012704174,	0,	0,	0.000529341,	0.016938899,	0.051875378,	0.011116152,	0,	0,	0.001739262,	0.055656382,	0.170447671,	0.036524501,	0,	0,	0.002117362,	0.067755596,	0.207501512,	0.04446461,	0,	0,	0.001512402,	0.048396854,	0.148215366,	0.031760436,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.000105452,	0.002214489,	0.007487082,	0.00168723,	0,	0,	0.000843615,	0.017715913,	0.059896657,	0.013497838,	0,	0,	0.000738163,	0.015501424,	0.052409575,	0.011810608,	0,	0,	0.002425393,	0.050933249,	0.172202889,	0.038806285,	0,	0,	0.002952652,	0.062005694,	0.2096383,	0.047242434,	0,	0,	0.002109037,	0.044289782,	0.149741643,	0.033744596,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.002873563,	0.00862069,	0,	0,	0,	0,	0.022988506,	0.068965517,	0,	0,	0,	0,	0.020114943,	0.060344828,	0,	0,	0,	0,	0.066091954,	0.198275862,	0,	0,	0,	0,	0.08045977,	0.24137931,	0,	0,	0,	0,	0.057471264,	0.172413793,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.009366925,	0.004521964,	0,	0,	0,	0,	0.05620155,	0.027131783,	0,	0,	0,	0,	0.159237726,	0.076873385,	0,	0,	0,	0,	0.149870801,	0.072351421,	0,	0,	0,	0,	0.299741602,	0.144702842,	0,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.002025463,	0.008680556,	0.00318287,	0,	0,	0,	0.012152778,	0.052083333,	0.019097222,	0,	0,	0,	0.03443287,	0.147569444,	0.054108796,	0,	0,	0,	0.032407407,	0.138888889,	0.050925926,	0,	0,	0,	0.064814815,	0.277777778,	0.101851852,	0,	0,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.00245098,	0.007352941,	0.003851541,	0.000233427,	0,	0,	0.014705882,	0.044117647,	0.023109244,	0.00140056,	0,	0,	0.041666667,	0.125,	0.06547619,	0.003968254,	0,	0,	0.039215686,	0.117647059,	0.06162465,	0.003734827,	0,	0,	0.078431373,	0.235294118,	0.1232493,	0.007469655,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.0000913743,	0.002923977,	0.008954678,	0.00191886,	0,	0,	0.000548246,	0.01754386,	0.05372807,	0.011513158,	0,	0,	0.001553363,	0.049707602,	0.152229532,	0.032620614,	0,	0,	0.001461988,	0.046783626,	0.143274854,	0.030701754,	0,	0,	0.002923977,	0.093567251,	0.286549708,	0.061403509,	0,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.000127421,	0.002675841,	0.009046891,	0.002038736,	0,	0,	0.000764526,	0.016055046,	0.054281346,	0.012232416,	0,	0,	0.002166157,	0.045489297,	0.153797146,	0.034658512,	0,	0,	0.002038736,	0.042813456,	0.144750255,	0.032619776,	0,	0,	0.004077472,	0.085626911,	0.28950051,	0.065239551,
                           0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0.003472222,	0.010416667,	0,	0,	0,	0,	0.020833333,	0.0625,	0,	0,	0,	0,	0.059027778,	0.177083333,	0,	0,	0,	0,	0.055555556,	0.166666667,	0,	0,	0,	0,	0.111111111,	0.333333333)
    #RetornosOpcionVenta =  read_excel(inFile$datapath, sheet = "Hoja2")
    RetornosOpcionVenta = matrix(data = c(281.25,	292.5,	303.75,	315,	326.25,	337.5,	343.75,	357.5,	371.25,	385,	398.75,	412.5,	406.25,	422.5,	438.75,	455,	471.25,	487.5,	468.75,	487.5,	506.25,	525,	543.75,	562.5,	531.25,	552.5,	573.75,	595,	616.25,	637.5,	593.75,	617.5,	641.25,	665,	688.75,	712.5,	656.25,	682.5,	708.75,	735,	761.25,	787.5,	718.75,	747.5,	776.25,	805,	833.75,	862.5,	781.25,	812.5,	843.75,	875,	906.25,	937.5,	843.75,	877.5,	911.25,	945,	978.75,	1012.5,	906.25,	942.5,	978.75,	1015,	1051.25,	1087.5,	968.75,	1007.5,	1046.25,	1085,	1123.75,	1162.5,
                                          17131250,	16737500,	16343750,	15950000,	15556250,	15162500,	14943750,	14462500,	13981250,	13500000,	13018750,	12537500,	12756250,	12187500,	11618750,	11050000,	10481250,	9912500,	10568750,	9912500,	9256250,	8600000,	7943750,	7287500,	8381250,	7637500,	6893750,	6150000,	5406250,	4662500,	6193750,	5362500,	4531250,	3700000,	2868750,	2037500,	4006250,	3087500,	2168750,	1250000,	331250,	-587500,	1818750,	812500,	-193750,	-1200000,	-2206250,	-3212500,	-368750.000000004,	-1462500,	-2556250,	-3650000,	-4743750,	-5837500,	-2556250,	-3737500.00000001,	-4918750.00000001,	-6100000.00000001,	-7281250.00000001,	-8462500.00000001,	-4743750.00000001,	-6012500.00000001,	-7281250.00000001,	-8550000.00000001,	-9818750.00000001,	-11087500,	-6931250.00000001,	-8287500.00000001,	-9643750.00000001,	-11000000,	-12356250,	-13712500,
                                          0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0), ncol = 3, nrow = 72)
    
    RetornosOpcionVenta
    ArchivoFinanzas =  read_excel(inFile$datapath, sheet = "Escenario")
    
    
    
    #Importar la matriz de precio en pesos
    Dia = 0
    PrecioPesos <- matrix(data = MatrizPrecioPesos, ncol = 72, nrow = 72)
    PrecioPesosPromedios <- c(281.25,292.5,303.75,315,326.25,337.5,343.75,357.5,371.25,385,398.75,412.5,406.25,422.5,438.75,455,471.25,487.5,468.75,487.5,506.25,525,543.75,562.5,531.25,552.5,573.75,595,616.25,637.5,593.75,617.5,641.25,665,688.75,712.5,656.25,682.5,708.75,735,761.25,787.5,718.75,747.5,776.25,805,833.75,862.5,781.25,812.5,843.75,875,906.25,937.5,843.75,877.5,911.25,945,978.75,1012.5,906.25,942.5,978.75,1015,1051.25,1087.5,968.75,1007.5,1046.25,1085,1123.75,1162.5)
    dimnames(PrecioPesos) = list(PrecioPesosPromedios,PrecioPesosPromedios)
    
    
    #Funciones
    darEstadoPP <- function(valorPesos){
      encontro <- FALSE
      for (i in 1:72) {
        if (PrecioPesosPromedios[i]==valorPesos) {
          return(i)
          encontro = TRUE
        }
      }
      
      if (encontro == FALSE) {
        menor <- 10000
        indice <- 0
        for (j in 1:72) {
          c <- abs(valorPesos - PrecioPesosPromedios[j])
          if (c < menor) {
            menor = c
            indice = j
          }
        }
        return(indice)
      }
      
      
    }
    darRetornoInst <- function(valorPesos){
      
      r <- (((2800*0.2875)-valorPesos)*1000*35)-1200000
      return(r)
    }
    
    ret = as.matrix(RetornosOpcionVenta)
    colnames(ret) = c("PrecioPesos","rVender","rEsperar")
    
    
    #Matriz de Bellman
    Bellman = NULL
    for (i in 1:90) {
      Bellman = cbind(Bellman,rep(0,72))
    } 
    
    for(i in 1:72){
      if (ret[i,2] > 0)
        Bellman[i,90] = ret[i,2]
    }
    
    
    #Matriz de la decision optima en cada caso posible
    Decisiones = NULL
    for (i in 1:90) {
      Decisiones = cbind(Decisiones,rep(0,72))
    } 
    
    for (i in 1:72) {
      if (Bellman[i,90] > 0) {
        Decisiones[i,90] = 1
      }
    }
    
    
    for (i in 1:89) {
      indice = 90-i
      for (j in 1:72) {
        filaInicial = PrecioPesos[j,]
        valorEsp = filaInicial%*%Bellman[,indice+1]
        
        opcionVenta = ret[j,2]
        opcionEsperar = valorEsp
        
        if (opcionVenta > opcionEsperar){
          Bellman[j,indice] = opcionVenta
          Decisiones[j,indice] = 1
        }else{
          Bellman[j,indice] = opcionEsperar
          Decisiones[j,indice] = 0
        }
        
      }
    }
    
    #Comparar el modelo con los datos suministrados
    P = as.matrix(ArchivoFinanzas$`Precio Rosa (USD)`)
    TRM = as.matrix(ArchivoFinanzas$`TRM ($COP/dlar)`)
    PresEsp = data.frame(P*TRM)
    
    #Se crea un vector con los estados correspondientes
    EstadosEsp = NULL
    for (i in 1:nrow(PresEsp)) {
      estado = darEstadoPP(PresEsp[i,])
      EstadosEsp[i] = estado
    }
    
    vendio = FALSE
    for (i in 1:90) {
      estadoEnDia = EstadosEsp[i]
      
      decision = Decisiones[estadoEnDia,i]
      if (decision == 1) {
        if(vendio == FALSE){
          Dia = i
          print(i)
          vendio = TRUE
        }
      }
    }
    #Guardo el valor del dia
    saveRDS(Dia, "Dia")
    
  })
  
  #Imprimir resultado del dia a escoger
  output$contents11 <- renderText({
    req(input$file1)
    
    #Leo el valor del dia
    if(readRDS("Dia") == 0){
      P = c("No se puede calcular")  
      P
    }
    P = c("El dia optimo para ejercer la opcion es: ", readRDS("Dia"))
    P
    
  })

  
  #Opcion de produccion
  output$"Toma de decicion en la alternativa de produccion" = renderText({"Toma de decicion en la alternativa de produccion"})
  output$contents2 <- renderTable({
    
    #Leo archivo
    req(input$file1)
    inFile <- input$file1
    Dema =  read_excel(inFile$datapath, sheet = "ListaDePedidos")
    Dem = Dema$`Cliente 1 (Cajas de rosas)`+Dema$`Cliente 2 (Cajas de rosas)`+Dema$`Cliente 3 (Cajas de rosas)`
    datosProd = matrix(ncol = 2, nrow = 1980)
    fila = 0 
    
    #Genero matriz de combinaciones de inventario y demanda
    for (i in 1:55) {
      for (j in 1:36) {
        fila = fila +1
        datosProd [fila, 1] = i
        datosProd [fila, 2] = 36 - j
      }
    }
    DatosColflores_Produccion = datosProd
    
    #Genero matrices necesarias para le calculo
    Demanda = data.frame(Dem)
    DV = matrix(nrow=26, ncol = 5)
    colnames(DV) = c("T",	"Demanda","Inventario", "Costo", "Decision de produccion")
    
    retP = as.matrix(DatosColflores_Produccion)
    Multima = cbind(rep(1, nrow(retP)), retP[,1:2], matrix(c(rep(NA)), nrow = nrow(retP), ncol=23))
    
    colnames(Multima) = c("T",	"Demanda","Inventario","0",	"1",	"2",	"3",	"4",	"5",	"6",	"7",	"8",	"9",	"10",	"11",	"12",	"13",	"14",	"15",	"16",	"17",	"18",	"19",	"20", "Max", "Decision")
    DF = data.frame(Multima)
    
    #Parametros de costos
    Cf = input$costofijo
    Cv = 37800
    Ca = 121500
    
    #Calculo de la produccion, nivel de inventario requerido
    for (i in 1:nrow(DF)) {
      for (j in 0:20) {
        
        if((j+DF[i, 3] < DF[i, 2]) || ((j-DF[i, 2])+DF[i, 3]>35)){
          DF[i, j+4] = -9999999999
        }
        else{
          CP=0
          if(j>0){
            CP=Cf
          }
          
          DF[i, j+4] = -(CP+j*Cv+(j-DF[i, 2]+DF[i, 3])*Ca)
        }
      }
      
      DF[i, 25] = max(DF[i, 4:24])
      DF[i, 26] = which.max(DF[i, 4:24])-1
      
    }
    
    #Actualizar demanda segun el dia de opcion financiera
    Dia = readRDS("Dia")
    
    Demanda[((Dia+14*7)/7),] = Demanda[((Dia+14*7)/7),] + 35
    Demanda[((Dia+14*7)/7),]
    
    
    DV[26,1] = 26
    DA = DF[DF$Demanda==Demanda[26,],]
    DV[26,2] = Demanda[26,]
    DV[26,3] = DA[which.max(DA[1:35, 25]),3]  
    DV[26,4] = DA[which.max(DA[1:35, 25]),25]
    DV[26,5] = DA[which.max(DA[1:35, 25]),26]
    
    for (i in (nrow(DV)-1):1) {
      
      DA = DF[DF$Demanda==Demanda[i,],1:24]
      inventario = 0
      
      
      if(Demanda[i,]>20){
        inventario = Demanda[i,] - 20
      }
      
      if((Demanda[i,]+DV[i+1, 3])>20){
        
        inventario1 = (Demanda[i,]+DV[i+1, 3])-20
        inventario = inventario + inventario1
        if(inventario>35){
          inventario = 35
        }
        
      }
      
      UB = which(DA==max(DA[1:(36-inventario), (4-(inventario)+Demanda[i,]+DV[i+1, 3]):24]), arr.ind = TRUE)
      DV[i,1] = i
      DV[i,2] = Demanda[i,]
      DV[i,4] = max(DA[1:(36-inventario),(4-(inventario)+Demanda[i,]+DV[i+1, 3]):24])
      DV[i,5] = UB[2]-4
      DV[i,3] = DA[UB[1], 3]  
    }
    
    DV
    Titulo = "Toma de decicion en produccion"
    saveRDS(DV[], file = "Matriz Produccion")
    
    
  })
  #Imprmo tabla con resultados
  output$contents12 <- renderTable({
    req(input$file1)
    DV = readRDS("Matriz Produccion")
  })
  
  #Imprmo tabla con resultados del costo total
  output$contents123 <- renderText({
    req(input$file1)
    DV = data.frame(readRDS("Matriz Produccion"))
    CT = 0
    for (i in 1:nrow(DV)) {
      CT = CT + DV[i,4]
    }
    CT
    P = c("Costo Total: ", CT)
    P
    
  })
  
  #Imprimo graficas
  
  output$G1 <- renderPlot({
    req(input$file1)
    DV = readRDS("Matriz Produccion")
    plot(DV[,3], xlab = "Semana", ylab = "Inventario", col = "blue", main = "Inventario para cada semana")
  })
  
  output$G2 <- renderPlot({
    req(input$file1)
    DV = readRDS("Matriz Produccion")
    plot(DV[,4], xlab = "Semana", ylab = "Costo", col = "blue", main = "Costo para cada semana")
  })
  
  output$G3 <- renderPlot({
    req(input$file1)
    DV = readRDS("Matriz Produccion")
    plot(DV[,5], xlab = "Semana", ylab = "Cantidad a producir", col = "blue", main = "Produccion para cada semana")
  })
  
  #Borrar Resultados al cambiar de tab
  observeEvent(input$tabset,{
    output$Resultados<-NULL
    output$G11<-NULL
    output$G22<-NULL
    output$G33<-NULL
    output$Alt1<-NULL
    output$Alt2<-NULL
    output$Alt3<-NULL
    output$Alt4<-NULL
    output$info1<-NULL
    output$info2<-NULL
    
  })
}

shinyApp(ui=ui, server=server)



































